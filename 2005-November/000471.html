<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Maay-svncheckins] r500 - in trunk/maay: . data
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/maay-svncheckins/2005-November/index.html" >
   <LINK REL="made" HREF="mailto:maay-svncheckins%40lists.berlios.de?Subject=Re%3A%20%5BMaay-svncheckins%5D%20r500%20-%20in%20trunk/maay%3A%20.%20data&In-Reply-To=%3C200511151351.jAFDpwaC018552%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000470.html">
   <LINK REL="Next"  HREF="000472.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Maay-svncheckins] r500 - in trunk/maay: . data</H1>
    <B>afayolle at BerliOS</B> 
    <A HREF="mailto:maay-svncheckins%40lists.berlios.de?Subject=Re%3A%20%5BMaay-svncheckins%5D%20r500%20-%20in%20trunk/maay%3A%20.%20data&In-Reply-To=%3C200511151351.jAFDpwaC018552%40sheep.berlios.de%3E"
       TITLE="[Maay-svncheckins] r500 - in trunk/maay: . data">afayolle at berlios.de
       </A><BR>
    <I>Tue Nov 15 14:51:58 CET 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000470.html">[Maay-svncheckins] r499 - trunk/maay
</A></li>
        <LI>Next message: <A HREF="000472.html">[Maay-svncheckins] r501 - trunk/maay
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#471">[ date ]</a>
              <a href="thread.html#471">[ thread ]</a>
              <a href="subject.html#471">[ subject ]</a>
              <a href="author.html#471">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: afayolle
Date: 2005-11-15 14:51:50 +0100 (Tue, 15 Nov 2005)
New Revision: 500

Added:
   trunk/maay/data/MochiKit.js
   trunk/maay/data/MochiKitLogConsole.js
   trunk/maay/data/athena.js
   trunk/maay/data/liveglue.js
   trunk/maay/data/livetest-postscripts.js
   trunk/maay/data/livetest.js
Modified:
   trunk/maay/webapplication.py
Log:
workaround for nevow having problems to find its js code once py2exe'd 


Added: trunk/maay/data/MochiKit.js
===================================================================
--- trunk/maay/data/MochiKit.js	2005-11-15 13:08:55 UTC (rev 499)
+++ trunk/maay/data/MochiKit.js	2005-11-15 13:51:50 UTC (rev 500)
@@ -0,0 +1,3930 @@
+/***
+
+    MochiKit.MochiKit 1.0 : PACKED VERSION
+
+    THIS FILE IS AUTOMATICALLY GENERATED.  If creating patches, please
+    diff against the source tree, not this file.
+
+    See &lt;<A HREF="http://mochikit.com/">http://mochikit.com/</A>&gt; for documentation, downloads, license, etc.
+
+    (c) 2005 Bob Ippolito.  All rights Reserved.
+
+***/
+
+if(typeof (dojo)!=&quot;undefined&quot;){
+dojo.provide(&quot;MochiKit.Compat&quot;);
+}
+if(typeof (MochiKit)==&quot;undefined&quot;){
+MochiKit={};
+}
+if(typeof (MochiKit.Compat)==&quot;undefined&quot;){
+MochiKit.Compat={};
+}
+MochiKit.Compat.NAME=&quot;MochiKit.Compat&quot;;
+MochiKit.Compat.VERSION=&quot;1.0&quot;;
+MochiKit.Compat.__repr__=function(){
+return &quot;[&quot;+this.NAME+&quot; &quot;+this.VERSION+&quot;]&quot;;
+};
+MochiKit.Compat.toString=function(){
+return this.__repr__();
+};
+if(!Array.prototype.push){
+Array.prototype.push=function(){
+var _1=this.length;
+for(var i=0;i&lt;arguments.length;i++){
+this[_1+i]=arguments[i];
+}
+return this.length;
+};
+}
+if(!Function.prototype.apply){
+Function.prototype.apply=function(_3,_4){
+var _5=[];
+if(!_3){
+_3=window;
+}
+if(!_4){
+_4=[];
+}
+for(var i=0;i&lt;_4.length;i++){
+_5[i]=&quot;parameters[&quot;+i+&quot;]&quot;;
+}
+_3.__apply__=this;
+var _6=eval(&quot;object.__apply__(&quot;+_5.join(&quot;, &quot;)+&quot;)&quot;);
+_3.__apply__=null;
+return _6;
+};
+}
+MochiKit.Compat.EXPORT=[];
+MochiKit.Compat.EXPORT_OK=[];
+MochiKit.Compat.EXPORT_TAGS={&quot;:all&quot;:[],&quot;:common&quot;:[]};
+if(typeof (dojo)!=&quot;undefined&quot;){
+dojo.provide(&quot;MochiKit.Base&quot;);
+}
+if(typeof (MochiKit)==&quot;undefined&quot;){
+MochiKit={};
+}
+if(typeof (MochiKit.Base)==&quot;undefined&quot;){
+MochiKit.Base={};
+}
+MochiKit.Base.VERSION=&quot;1.0&quot;;
+MochiKit.Base.NAME=&quot;MochiKit.Base&quot;;
+MochiKit.Base.__repr__=function(){
+return &quot;[&quot;+this.NAME+&quot; &quot;+this.VERSION+&quot;]&quot;;
+};
+MochiKit.Base.toString=function(){
+return this.__repr__();
+};
+MochiKit.Base.clone=function(_7){
+var me=arguments.callee;
+if(arguments.length==1){
+me.prototype=_7;
+return new me();
+}
+};
+MochiKit.Base.extend=function(_9,obj,_11){
+if(!_11){
+_11=0;
+}
+if(obj){
+var l=obj.length;
+if(typeof (l)!=&quot;number&quot;){
+if(MochiKit.Iter){
+obj=MochiKit.Iter.list(obj);
+l=obj.length;
+}else{
+throw new TypeError(&quot;Argument not an array-like and MochiKit.Iter not present&quot;);
+}
+}
+if(!_9){
+_9=[];
+}
+for(var i=_11;i&lt;l;i++){
+_9.push(obj[i]);
+}
+}
+return _9;
+};
+MochiKit.Base.updatetree=function(_13,obj){
+if(_13==null){
+_13={};
+}
+for(var i=1;i&lt;arguments.length;i++){
+var o=arguments[i];
+if(typeof (o)!=&quot;undefined&quot;&amp;&amp;o!=null){
+for(var k in o){
+var v=o[k];
+if(typeof (_13[k])==&quot;object&quot;&amp;&amp;typeof (v)==&quot;object&quot;){
+arguments.callee(_13[k],v);
+}else{
+_13[k]=v;
+}
+}
+}
+}
+return _13;
+};
+MochiKit.Base.update=function(_17,obj){
+if(_17==null){
+_17={};
+}
+for(var i=1;i&lt;arguments.length;i++){
+var o=arguments[i];
+if(typeof (o)!=&quot;undefined&quot;&amp;&amp;o!=null){
+for(var k in o){
+_17[k]=o[k];
+}
+}
+}
+return _17;
+};
+MochiKit.Base.setdefault=function(_18,obj){
+if(_18==null){
+_18={};
+}
+for(var i=1;i&lt;arguments.length;i++){
+var o=arguments[i];
+for(var k in o){
+if(!(k in _18)){
+_18[k]=o[k];
+}
+}
+}
+return _18;
+};
+MochiKit.Base.keys=function(obj){
+var _19=[];
+for(var _20 in obj){
+_19.push(_20);
+}
+return _19;
+};
+MochiKit.Base.items=function(obj){
+var _21=[];
+for(var _22 in obj){
+_21.push([_22,obj[_22]]);
+}
+return _21;
+};
+MochiKit.Base.NamedError=function(_23){
+this.message=_23;
+this.name=_23;
+};
+MochiKit.Base.NamedError.prototype=new Error();
+MochiKit.Base.NamedError.prototype.repr=function(){
+if(this.message&amp;&amp;this.message!=this.name){
+return this.name+&quot;(&quot;+repr(this.message)+&quot;)&quot;;
+}else{
+return this.name+&quot;()&quot;;
+}
+};
+MochiKit.Base.NamedError.prototype.toString=function(){
+return this.repr();
+};
+MochiKit.Base.operator={&quot;truth&quot;:function(a){
+return !!a;
+},&quot;lognot&quot;:function(a){
+return !a;
+},&quot;identity&quot;:function(a){
+return a;
+},&quot;not&quot;:function(a){
+return ~a;
+},&quot;neg&quot;:function(a){
+return -a;
+},&quot;add&quot;:function(a,b){
+return a+b;
+},&quot;sub&quot;:function(a,b){
+return a-b;
+},&quot;div&quot;:function(a,b){
+return a/b;
+},&quot;mod&quot;:function(a,b){
+return a%b;
+},&quot;and&quot;:function(a,b){
+return a&b;
+},&quot;or&quot;:function(a,b){
+return a|b;
+},&quot;xor&quot;:function(a,b){
+return a^b;
+},&quot;lshift&quot;:function(a,b){
+return a&lt;&lt;b;
+},&quot;rshift&quot;:function(a,b){
+return a&gt;&gt;b;
+},&quot;zrshift&quot;:function(a,b){
+return a&gt;&gt;&gt;b;
+},&quot;eq&quot;:function(a,b){
+return a==b;
+},&quot;ne&quot;:function(a,b){
+return a!=b;
+},&quot;gt&quot;:function(a,b){
+return a&gt;b;
+},&quot;ge&quot;:function(a,b){
+return a&gt;=b;
+},&quot;lt&quot;:function(a,b){
+return a&lt;b;
+},&quot;le&quot;:function(a,b){
+return a&lt;=b;
+},&quot;ceq&quot;:function(a,b){
+return MochiKit.Base.compare(a,b)==0;
+},&quot;cne&quot;:function(a,b){
+return MochiKit.Base.compare(a,b)!=0;
+},&quot;cgt&quot;:function(a,b){
+return MochiKit.Base.compare(a,b)==1;
+},&quot;cge&quot;:function(a,b){
+return MochiKit.Base.compare(a,b)!=-1;
+},&quot;clt&quot;:function(a,b){
+return MochiKit.Base.compare(a,b)==-1;
+},&quot;cle&quot;:function(a,b){
+return MochiKit.Base.compare(a,b)!=1;
+},&quot;logand&quot;:function(a,b){
+return a&amp;&b;
+},&quot;logor&quot;:function(a,b){
+return a||b;
+},&quot;contains&quot;:function(a,b){
+return b in a;
+}};
+MochiKit.Base.forward=function(_26){
+return function(){
+return this[_26].apply(this,arguments);
+};
+};
+MochiKit.Base.itemgetter=function(_27){
+return function(arg){
+return arg[_27];
+};
+};
+MochiKit.Base.typeMatcher=function(){
+var _29={};
+for(var i=0;i&lt;arguments.length;i++){
+var typ=arguments[i];
+_29[typ]=typ;
+}
+return function(){
+for(var i=0;i&lt;arguments.length;i++){
+if(!(typeof (arguments[i]) in _29)){
+return false;
+}
+}
+return true;
+};
+};
+MochiKit.Base.isNull=function(){
+for(var i=0;i&lt;arguments.length;i++){
+if(arguments[i]!=null){
+return false;
+}
+}
+return true;
+};
+MochiKit.Base.isUndefinedOrNull=function(){
+for(var i=0;i&lt;arguments.length;i++){
+var o=arguments[i];
+if(!(typeof (o)==&quot;undefined&quot;||o==null)){
+return false;
+}
+}
+return true;
+};
+MochiKit.Base.isNotEmpty=function(obj){
+for(var i=0;i&lt;arguments.length;i++){
+var o=arguments[i];
+if(!(o&amp;&amp;o.length)){
+return false;
+}
+}
+return true;
+};
+MochiKit.Base.isArrayLike=function(){
+for(var i=0;i&lt;arguments.length;i++){
+var o=arguments[i];
+var typ=typeof (o);
+if((typ!=&quot;object&quot;&amp;&amp;!(typ==&quot;function&quot;&amp;&amp;typeof (o.item)==&quot;function&quot;))||o==null||typeof (o.length)!=&quot;number&quot;){
+return false;
+}
+}
+return true;
+};
+MochiKit.Base.isDateLike=function(){
+for(var i=0;i&lt;arguments.length;i++){
+var o=arguments[i];
+if(typeof (o)!=&quot;object&quot;||typeof (o.getTime)!=&quot;function&quot;){
+return false;
+}
+}
+return true;
+};
+MochiKit.Base.xmap=function(fn){
+if(fn==null){
+return MochiKit.Base.extend(null,arguments,1);
+}
+var _32=[];
+for(var i=1;i&lt;arguments.length;i++){
+_32.push(fn(arguments[i]));
+}
+return _32;
+};
+MochiKit.Base.map=function(fn,lst){
+var _34=MochiKit.Base.isArrayLike;
+if(arguments.length&lt;=2){
+if(!_34(lst)){
+if(MochiKit.Iter){
+lst=MochiKit.Iter.list(lst);
+if(fn==null){
+return lst;
+}
+}else{
+throw new TypeError(&quot;Argument not an array-like and MochiKit.Iter not present&quot;);
+}
+}
+if(fn==null){
+return MochiKit.Base.extend(null,lst);
+}
+if(false&amp;&amp;typeof (Array.prototype.map)==&quot;function&quot;){
+return Array.prototype.map.call(lst,fn);
+}
+var _35=[];
+for(var i=0;i&lt;lst.length;i++){
+_35.push(fn(lst[i]));
+}
+return _35;
+}else{
+if(fn==null){
+fn=Array;
+}
+var _36=null;
+for(i=1;i&lt;arguments.length;i++){
+if(!_34(arguments[i])){
+if(MochiKit.Iter){
+arguments[i]=MochiKit.Iter.list(arguments[i]);
+}else{
+throw new TypeError(&quot;Argument not an array-like and MochiKit.Iter not present&quot;);
+}
+}
+var l=arguments[i].length;
+if(_36==null||_36&gt;l){
+_36=l;
+}
+}
+_35=[];
+for(i=0;i&lt;_36;i++){
+var _37=[];
+for(var j=1;j&lt;arguments.length;j++){
+_37.push(arguments[j][i]);
+}
+_35.push(fn.apply(this,_37));
+}
+return _35;
+}
+};
+MochiKit.Base.xfilter=function(fn){
+var _39=[];
+if(fn==null){
+fn=MochiKit.Base.operator.truth;
+}
+for(var i=1;i&lt;arguments.length;i++){
+var o=arguments[i];
+if(fn(o)){
+_39.push(o);
+}
+}
+return _39;
+};
+MochiKit.Base.filter=function(fn,lst,_40){
+var _41=[];
+if(!MochiKit.Base.isArrayLike(lst)){
+if(MochiKit.Iter){
+lst=MochiKit.Iter.list(lst);
+}else{
+throw new TypeError(&quot;Argument not an array-like and MochiKit.Iter not present&quot;);
+}
+}
+if(fn==null){
+fn=MochiKit.Base.operator.truth;
+}
+if(typeof (Array.prototype.filter)==&quot;function&quot;){
+return Array.prototype.filter.call(lst,fn,_40);
+}else{
+if(typeof (_40)==&quot;undefined&quot;||_40==null){
+for(var i=0;i&lt;lst.length;i++){
+var o=lst[i];
+if(fn(o)){
+_41.push(o);
+}
+}
+}else{
+for(i=0;i&lt;lst.length;i++){
+o=lst[i];
+if(fn.call(_40,o)){
+_41.push(o);
+}
+}
+}
+}
+return _41;
+};
+MochiKit.Base._wrapDumpFunction=function(_42){
+return function(){
+switch(arguments.length){
+case 0:
+return _42();
+case 1:
+return _42(arguments[0]);
+case 2:
+return _42(arguments[0],arguments[1]);
+case 3:
+return _42(arguments[0],arguments[1],arguments[2]);
+}
+var _43=[];
+for(var i=0;i&lt;arguments.length;i++){
+_43.push(&quot;arguments[&quot;+i+&quot;]&quot;);
+}
+return eval(&quot;(func(&quot;+_43.join(&quot;,&quot;)+&quot;))&quot;);
+};
+};
+MochiKit.Base.bind=function(_44,_45){
+var _46=_44.im_func;
+var _47=_44.im_preargs;
+var _48=_44.im_self;
+if(typeof (_44)==&quot;function&quot;&amp;&amp;typeof (_44.apply)==&quot;undefined&quot;){
+_44=MochiKit.Base._wrapDumbFunction(_44);
+}
+if(typeof (_46)!=&quot;function&quot;){
+_46=_44;
+}
+if(typeof (_45)!=&quot;undefined&quot;){
+_48=_45;
+}
+if(typeof (_47)==&quot;undefined&quot;){
+_47=[];
+}else{
+_47=_47.slice();
+}
+MochiKit.Base.extend(_47,arguments,2);
+var _49=function(){
+var _50=arguments;
+var me=arguments.callee;
+if(me.im_preargs.length&gt;0){
+_50=MochiKit.Base.concat(me.im_preargs,_50);
+}
+var _45=me.im_self;
+if(!_45){
+_45=this;
+}
+return me.im_func.apply(_45,_50);
+};
+_49.im_self=_48;
+_49.im_func=_46;
+_49.im_preargs=_47;
+return _49;
+};
+MochiKit.Base.bindMethods=function(_51){
+for(var k in _51){
+var _52=_51[k];
+if(typeof (_52)==&quot;function&quot;){
+_51[k]=bind(_52,_51);
+}
+}
+};
+MochiKit.Base.NotFound=new MochiKit.Base.NamedError(&quot;MochiKit.Base.NotFound&quot;);
+MochiKit.Base.AdapterRegistry=function(){
+this.pairs=[];
+};
+MochiKit.Base.AdapterRegistry.prototype.register=function(_53,_54,_55,_56){
+if(_56){
+this.pairs.unshift([_53,_54,_55]);
+}else{
+this.pairs.push([_53,_54,_55]);
+}
+};
+MochiKit.Base.AdapterRegistry.prototype.match=function(){
+for(var i=0;i&lt;this.pairs.length;i++){
+var _57=this.pairs[i];
+if(_57[1].apply(this,arguments)){
+return _57[2].apply(this,arguments);
+}
+}
+throw MochiKit.Base.NotFound;
+};
+MochiKit.Base.AdapterRegistry.prototype.unregister=function(_58){
+for(var i=0;i&lt;this.pairs.length;i++){
+var _59=this.pairs[i];
+if(_59[0]==_58){
+this.pairs.splice(i,1);
+return true;
+}
+}
+return false;
+};
+MochiKit.Base.registerComparator=function(_60,_61,_62,_63){
+MochiKit.Base.comparatorRegistry.register(_60,_61,_62,_63);
+};
+MochiKit.Base.compare=function(a,b){
+if(a==b){
+return 0;
+}
+var _64=(typeof (a)==&quot;undefined&quot;||a==null);
+var _65=(typeof (b)==&quot;undefined&quot;||b==null);
+if(_64&amp;&amp;_65){
+return 0;
+}else{
+if(_64){
+return -1;
+}else{
+if(_65){
+return 1;
+}
+}
+}
+try{
+return MochiKit.Base.comparatorRegistry.match(a,b);
+}
+catch(e){
+if(e!=MochiKit.Base.NotFound){
+throw e;
+}
+if(a&lt;b){
+return -1;
+}else{
+if(a&gt;b){
+return 1;
+}
+}
+var _66=MochiKit.Base.repr;
+throw new TypeError(_66(a)+&quot; and &quot;+_66(b)+&quot; can not be compared&quot;);
+}
+};
+MochiKit.Base.compareDateLike=function(a,b){
+a=a.getTime();
+b=b.getTime();
+if(a==b){
+return 0;
+}else{
+if(a&lt;b){
+return -1;
+}else{
+if(a&gt;b){
+return 1;
+}
+}
+}
+var _67=MochiKit.Base.repr;
+throw new TypeError(_67(a)+&quot; and &quot;+_67(b)+&quot; can not be compared&quot;);
+};
+MochiKit.Base.compareArrayLike=function(a,b){
+var _68=MochiKit.Base.compare;
+var _69=a.length;
+var _70=0;
+if(_69&gt;b.length){
+_70=1;
+_69=b.length;
+}else{
+if(_69&lt;b.length){
+_70=-1;
+}
+}
+for(var i=0;i&lt;_69;i++){
+var cmp=_68(a[i],b[i]);
+if(cmp){
+return cmp;
+}
+}
+return _70;
+};
+MochiKit.Base.registerRepr=function(_72,_73,_74,_75){
+MochiKit.Base.reprRegistry.register(_72,_73,_74,_75);
+};
+MochiKit.Base.repr=function(o){
+if(typeof (o)==&quot;undefined&quot;){
+return &quot;undefined&quot;;
+}else{
+if(o===null){
+return &quot;null&quot;;
+}
+}
+try{
+if(typeof (o.__repr__)==&quot;function&quot;){
+return o.__repr__();
+}else{
+if(typeof (o.repr)==&quot;function&quot;&amp;&amp;o.repr!=arguments.callee){
+return o.repr();
+}
+}
+return MochiKit.Base.reprRegistry.match(o);
+}
+catch(e){
+if(typeof (o.NAME)==&quot;string&quot;&amp;&amp;(o.toString==Function.prototype.toString||o.toString==Object.prototype.toString)){
+return o.NAME;
+}
+}
+if(typeof (o)==&quot;function&quot;){
+o=(o+&quot;&quot;);
+o=o.replace(/^\s+/,&quot;&quot;);
+o=o.replace(/\s+$/,&quot;&quot;);
+var idx=o.indexOf(&quot;{&quot;);
+if(idx!=-1){
+o=o.substr(0,idx)+&quot;{...}&quot;;
+}
+}
+return o+&quot;&quot;;
+};
+MochiKit.Base.reprArrayLike=function(o){
+return &quot;[&quot;+MochiKit.Base.map(MochiKit.Base.repr,o).join(&quot;, &quot;)+&quot;]&quot;;
+};
+MochiKit.Base.reprString=function(o){
+o=&quot;\&quot;&quot;+o.replace(/([&quot;\\])/g,&quot;\\$1&quot;)+&quot;\&quot;&quot;;
+o=o.replace(/[\f]/g,&quot;\\f&quot;);
+o=o.replace(/[\b]/g,&quot;\\b&quot;);
+o=o.replace(/[\n]/g,&quot;\\n&quot;);
+o=o.replace(/[\t]/g,&quot;\\t&quot;);
+o=o.replace(/[\r]/g,&quot;\\r&quot;);
+return o;
+};
+MochiKit.Base.reprNumber=function(o){
+return o.toString();
+};
+MochiKit.Base.registerJSON=function(_77,_78,_79,_80){
+MochiKit.Base.jsonRegistry.register(_77,_78,_79,_80);
+};
+MochiKit.Base.evalJSON=function(o){
+return eval(&quot;(&quot;+o+&quot;)&quot;);
+};
+MochiKit.Base.serializeJSON=function(o){
+var _81=typeof (o);
+if(_81==&quot;undefined&quot;){
+return &quot;undefined&quot;;
+}else{
+if(_81==&quot;number&quot;||_81==&quot;boolean&quot;){
+return o.toString();
+}else{
+if(o===null){
+return &quot;null&quot;;
+}
+}
+}
+var _82=MochiKit.Base.reprString;
+if(_81==&quot;string&quot;){
+return _82(o);
+}
+var me=arguments.callee;
+var _83;
+if(typeof (o.__json__)==&quot;function&quot;){
+_83=o.__json__();
+if(o!==_83){
+return me(_83);
+}
+}
+if(typeof (o.json)==&quot;function&quot;){
+_83=o.json();
+if(o!==_83){
+return me(_83);
+}
+}
+if(_81!=&quot;function&quot;&amp;&amp;typeof (o.length)==&quot;number&quot;){
+var res=[];
+for(var i=0;i&lt;o.length;i++){
+var val=me(o[i]);
+if(typeof (val)!=&quot;string&quot;){
+val=&quot;undefined&quot;;
+}
+res.push(val);
+}
+return &quot;[&quot;+res.join(&quot;,&quot;)+&quot;]&quot;;
+}
+try{
+_83=MochiKit.Base.jsonRegistry.match(o);
+return me(_83);
+}
+catch(e){
+if(e!=MochiKit.Base.NotFound){
+throw e;
+}
+}
+if(_81==&quot;function&quot;){
+return null;
+}
+res=[];
+for(var k in o){
+var _86;
+if(typeof (k)==&quot;number&quot;){
+_86=&quot;\&quot;&quot;+k.toString()+&quot;\&quot;&quot;;
+}else{
+if(typeof (k)==&quot;string&quot;){
+_86=_82(k);
+}else{
+continue;
+}
+}
+val=me(o[k]);
+if(typeof (val)!=&quot;string&quot;){
+continue;
+}
+res.push(_86+&quot;:&quot;+val);
+}
+return &quot;{&quot;+res.join(&quot;,&quot;)+&quot;}&quot;;
+};
+MochiKit.Base.objEqual=function(a,b){
+return (MochiKit.Base.compare(a,b)==0);
+};
+MochiKit.Base.arrayEqual=function(_87,arr){
+if(_87.length!=arr.length){
+return false;
+}
+return (MochiKit.Base.compare(_87,arr)==0);
+};
+MochiKit.Base.concat=function(){
+var _89=[];
+var _90=MochiKit.Base.extend;
+for(var i=0;i&lt;arguments.length;i++){
+_90(_89,arguments[i]);
+}
+return _89;
+};
+MochiKit.Base.keyComparator=function(key){
+var _92=MochiKit.Base.compare;
+if(arguments.length==1){
+return function(a,b){
+return _92(a[key],b[key]);
+};
+}
+var _93=MochiKit.Base.extend(null,arguments);
+return function(a,b){
+var _94=0;
+for(var i=0;(_94==0)&amp;&amp;(i&lt;_93.length);i++){
+var key=_93[i];
+_94=_92(a[key],b[key]);
+}
+return _94;
+};
+};
+MochiKit.Base.reverseKeyComparator=function(key){
+var _95=MochiKit.Base.keyComparator.apply(this,arguments);
+return function(a,b){
+return _95(b,a);
+};
+};
+MochiKit.Base.partial=function(_96){
+return MochiKit.Base.bind.apply(this,MochiKit.Base.extend([_96,undefined],arguments,1));
+};
+MochiKit.Base.listMinMax=function(_97,lst){
+if(lst.length==0){
+return null;
+}
+var cur=lst[0];
+var _99=MochiKit.Base.compare;
+for(var i=1;i&lt;lst.length;i++){
+var o=lst[i];
+if(_99(o,cur)==_97){
+cur=o;
+}
+}
+return cur;
+};
+MochiKit.Base.objMax=function(){
+return MochiKit.Base.listMinMax(1,arguments);
+};
+MochiKit.Base.objMin=function(){
+return MochiKit.Base.listMinMax(-1,arguments);
+};
+MochiKit.Base.nodeWalk=function(node,_101){
+var _102=[node];
+var _103=MochiKit.Base.extend;
+while(_102.length){
+var res=_101(_102.shift());
+if(res){
+_103(_102,res);
+}
+}
+};
+MochiKit.Base.nameFunctions=function(_104){
+var base=_104.NAME;
+if(typeof (base)==&quot;undefined&quot;){
+base=&quot;&quot;;
+}else{
+base=base+&quot;.&quot;;
+}
+for(var name in _104){
+var o=_104[name];
+if(typeof (o)==&quot;function&quot;&amp;&amp;typeof (o.NAME)==&quot;undefined&quot;){
+try{
+o.NAME=base+name;
+}
+catch(e){
+}
+}
+}
+};
+if(typeof (encodeURIComponent)!=&quot;undefined&quot;){
+MochiKit.Base.urlEncode=function(_107){
+var rval=encodeURIComponent(_107);
+return rval.replace(/\'/g,&quot;%27&quot;);
+};
+}else{
+MochiKit.Base.urlEncode=function(_109){
+var rval=escape(_109).replace(/\+/g,&quot;%2B&quot;).replace(/\&quot;/g,&quot;%22&quot;);
+return rval.replace(/\'/g,&quot;%27&quot;);
+};
+}
+MochiKit.Base.queryString=function(_110,_111){
+if(arguments.length==1){
+var o=_110;
+_110=[];
+_111=[];
+for(var k in o){
+var v=o[k];
+if(typeof (v)!=&quot;function&quot;){
+_110.push(k);
+_111.push(v);
+}
+}
+}
+var rval=[];
+var len=Math.min(_110.length,_111.length);
+var _113=MochiKit.Base.urlEncode;
+for(var i=0;i&lt;len;i++){
+v=_111[i];
+if(typeof (v)!=&quot;undefined&quot;&amp;&amp;v!=null){
+rval.push(_113(_110[i])+&quot;=&quot;+_113(v));
+}
+}
+return rval.join(&quot;&amp;&quot;);
+};
+MochiKit.Base.parseQueryString=function(_114,_115){
+var _116=_114.replace(/\+/g,&quot;%20&quot;).split(&quot;&amp;&quot;);
+var o={};
+var _117;
+if(typeof (decodeURIComponent)!=&quot;undefined&quot;){
+_117=decodeURIComponent;
+}else{
+_117=unescape;
+}
+if(_115){
+for(var i=0;i&lt;_116.length;i++){
+var pair=_116[i].split(&quot;=&quot;);
+var name=_117(pair[0]);
+var arr=o[name];
+if(!(arr instanceof Array)){
+arr=[];
+o[name]=arr;
+}
+arr.push(_117(pair[1]));
+}
+}else{
+for(i=0;i&lt;_116.length;i++){
+pair=_116[i].split(&quot;=&quot;);
+o[_117(pair[0])]=_117(pair[1]);
+}
+}
+return o;
+};
+MochiKit.Base.EXPORT=[&quot;clone&quot;,&quot;extend&quot;,&quot;update&quot;,&quot;updatetree&quot;,&quot;setdefault&quot;,&quot;keys&quot;,&quot;items&quot;,&quot;NamedError&quot;,&quot;operator&quot;,&quot;forward&quot;,&quot;itemgetter&quot;,&quot;typeMatcher&quot;,&quot;isCallable&quot;,&quot;isUndefined&quot;,&quot;isUndefinedOrNull&quot;,&quot;isNull&quot;,&quot;isNotEmpty&quot;,&quot;isArrayLike&quot;,&quot;isDateLike&quot;,&quot;xmap&quot;,&quot;map&quot;,&quot;xfilter&quot;,&quot;filter&quot;,&quot;bind&quot;,&quot;bindMethods&quot;,&quot;NotFound&quot;,&quot;AdapterRegistry&quot;,&quot;registerComparator&quot;,&quot;compare&quot;,&quot;registerRepr&quot;,&quot;repr&quot;,&quot;objEqual&quot;,&quot;arrayEqual&quot;,&quot;concat&quot;,&quot;keyComparator&quot;,&quot;reverseKeyComparator&quot;,&quot;partial&quot;,&quot;merge&quot;,&quot;listMinMax&quot;,&quot;listMax&quot;,&quot;listMin&quot;,&quot;objMax&quot;,&quot;objMin&quot;,&quot;nodeWalk&quot;,&quot;zip&quot;,&quot;urlEncode&quot;,&quot;queryString&quot;,&quot;serializeJSON&quot;,&quot;registerJSON&quot;,&quot;evalJSON&quot;,&quot;parseQueryString&quot;];
+MochiKit.Base.EXPORT_OK=[&quot;nameFunctions&quot;,&quot;comparatorRegistry&quot;,&quot;reprRegistry&quot;,&quot;jsonRegistry&quot;,&quot;compareDateLike&quot;,&quot;compareArrayLike&quot;,&quot;reprArrayLike&quot;,&quot;reprString&quot;,&quot;reprNumber&quot;];
+MochiKit.Base.__new__=function(){
+this.listMax=this.partial(this.listMinMax,1);
+this.listMin=this.partial(this.listMinMax,-1);
+this.isCallable=this.typeMatcher(&quot;function&quot;);
+this.isUndefined=this.typeMatcher(&quot;undefined&quot;);
+this.merge=this.partial(this.update,null);
+this.zip=this.partial(this.map,null);
+this.comparatorRegistry=new this.AdapterRegistry();
+this.registerComparator(&quot;dateLike&quot;,this.isDateLike,this.compareDateLike);
+this.registerComparator(&quot;arrayLike&quot;,this.isArrayLike,this.compareArrayLike);
+this.reprRegistry=new this.AdapterRegistry();
+this.registerRepr(&quot;arrayLike&quot;,this.isArrayLike,this.reprArrayLike);
+this.registerRepr(&quot;string&quot;,this.typeMatcher(&quot;string&quot;),this.reprString);
+this.registerRepr(&quot;numbers&quot;,this.typeMatcher(&quot;number&quot;,&quot;boolean&quot;),this.reprNumber);
+this.jsonRegistry=new this.AdapterRegistry();
+var all=this.concat(this.EXPORT,this.EXPORT_OK);
+this.EXPORT_TAGS={&quot;:common&quot;:this.concat(this.EXPORT_OK),&quot;:all&quot;:all};
+this.nameFunctions(this);
+};
+MochiKit.Base.__new__();
+compare=MochiKit.Base.compare;
+if((typeof (JSAN)==&quot;undefined&quot;&amp;&amp;typeof (dojo)==&quot;undefined&quot;)||(typeof (MochiKit.__compat__)==&quot;boolean&quot;&amp;&amp;MochiKit.__compat__)){
+(function(self){
+var all=self.EXPORT_TAGS[&quot;:all&quot;];
+for(var i=0;i&lt;all.length;i++){
+this[all[i]]=self[all[i]];
+}
+})(MochiKit.Base);
+}
+if(typeof (dojo)!=&quot;undefined&quot;){
+dojo.provide(&quot;MochiKit.Iter&quot;);
+dojo.require(&quot;MochiKit.Base&quot;);
+}
+if(typeof (JSAN)!=&quot;undefined&quot;){
+JSAN.use(&quot;MochiKit.Base&quot;,[]);
+}
+try{
+if(typeof (MochiKit.Base)==&quot;undefined&quot;){
+throw &quot;&quot;;
+}
+}
+catch(e){
+throw &quot;MochiKit.Iter depends on MochiKit.Base!&quot;;
+}
+if(typeof (MochiKit.Iter)==&quot;undefined&quot;){
+MochiKit.Iter={};
+}
+MochiKit.Iter.NAME=&quot;MochiKit.Iter&quot;;
+MochiKit.Iter.VERSION=&quot;1.0&quot;;
+MochiKit.Iter.__repr__=function(){
+return &quot;[&quot;+this.NAME+&quot; &quot;+this.VERSION+&quot;]&quot;;
+};
+MochiKit.Iter.toString=function(){
+return this.__repr__();
+};
+MochiKit.Iter.registerIteratorFactory=function(name,_121,_122,_123){
+MochiKit.Iter.iteratorRegistry.register(name,_121,_122,_123);
+};
+MochiKit.Iter.iter=function(_124,_125){
+if(arguments.length==2){
+return MochiKit.Iter.takewhile(function(a){
+return a!=_125;
+},_124);
+}
+if(typeof (_124.next)==&quot;function&quot;){
+return _124;
+}else{
+if(typeof (_124.iter)==&quot;function&quot;){
+return _124.iter();
+}
+}
+try{
+return MochiKit.Iter.iteratorRegistry.match(_124);
+}
+catch(e){
+if(e==MochiKit.Base.NotFound){
+e=new TypeError(typeof (_124)+&quot;: &quot;+MochiKit.Base.repr(_124)+&quot; is not iterable&quot;);
+}
+throw e;
+}
+};
+MochiKit.Iter.count=function(n){
+if(!n){
+n=0;
+}
+return {&quot;repr&quot;:function(){
+return &quot;count(&quot;+n+&quot;)&quot;;
+},&quot;toString&quot;:MochiKit.Base.forward(&quot;repr&quot;),&quot;next&quot;:function(){
+return n++;
+}};
+};
+MochiKit.Iter.cycle=function(p){
+var lst=[];
+var _128=MochiKit.Iter.iter(p);
+return {&quot;repr&quot;:function(){
+return &quot;cycle(...)&quot;;
+},&quot;toString&quot;:MochiKit.Base.forward(&quot;repr&quot;),&quot;next&quot;:function(){
+try{
+var rval=_128.next();
+lst.push(rval);
+return rval;
+}
+catch(e){
+if(e!=MochiKit.Iter.StopIteration){
+throw e;
+}
+if(lst.length==0){
+this.next=function(){
+throw MochiKit.Iter.StopIteration;
+};
+}else{
+var i=-1;
+this.next=function(){
+i=(i+1)%lst.length;
+return lst[i];
+};
+}
+return this.next();
+}
+}};
+};
+MochiKit.Iter.repeat=function(elem,n){
+if(typeof (n)==&quot;undefined&quot;){
+return {&quot;repr&quot;:function(){
+return &quot;repeat(&quot;+MochiKit.Base.repr(elem)+&quot;)&quot;;
+},&quot;toString&quot;:MochiKit.Base.forward(&quot;repr&quot;),&quot;next&quot;:function(){
+return elem;
+}};
+}
+return {&quot;repr&quot;:function(){
+return &quot;repeat(&quot;+MochiKit.Base.repr(elem)+&quot;, &quot;+n+&quot;)&quot;;
+},&quot;toString&quot;:MochiKit.Base.forward(&quot;repr&quot;),&quot;next&quot;:function(){
+if(n&lt;=0){
+throw MochiKit.Iter.StopIteration;
+}
+n-=1;
+return elem;
+}};
+};
+MochiKit.Iter.next=function(_130){
+return _130.next();
+};
+MochiKit.Iter.izip=function(p,q){
+var map=MochiKit.Base.map;
+var next=MochiKit.Iter.next;
+var _134=map(iter,arguments);
+return {&quot;repr&quot;:function(){
+return &quot;izip(...)&quot;;
+},&quot;toString&quot;:MochiKit.Base.forward(&quot;repr&quot;),&quot;next&quot;:function(){
+return map(next,_134);
+}};
+};
+MochiKit.Iter.ifilter=function(pred,seq){
+seq=MochiKit.Iter.iter(seq);
+if(pred==null){
+pred=MochiKit.Base.operator.truth;
+}
+return {&quot;repr&quot;:function(){
+return &quot;ifilter(...)&quot;;
+},&quot;toString&quot;:MochiKit.Base.forward(&quot;repr&quot;),&quot;next&quot;:function(){
+while(true){
+var rval=seq.next();
+if(pred(rval)){
+return rval;
+}
+}
+return undefined;
+}};
+};
+MochiKit.Iter.ifilterfalse=function(pred,seq){
+seq=MochiKit.Iter.iter(seq);
+if(pred==null){
+pred=MochiKit.Base.operator.truth;
+}
+return {&quot;repr&quot;:function(){
+return &quot;ifilterfalse(...)&quot;;
+},&quot;toString&quot;:MochiKit.Base.forward(&quot;repr&quot;),&quot;next&quot;:function(){
+while(true){
+var rval=seq.next();
+if(!pred(rval)){
+return rval;
+}
+}
+return undefined;
+}};
+};
+MochiKit.Iter.islice=function(seq){
+seq=MochiKit.Iter.iter(seq);
+var _137=0;
+var stop=0;
+var step=1;
+var i=-1;
+if(arguments.length==2){
+stop=arguments[1];
+}else{
+if(arguments.length==3){
+_137=arguments[1];
+stop=arguments[2];
+}else{
+_137=arguments[1];
+stop=arguments[2];
+step=arguments[3];
+}
+}
+return {&quot;repr&quot;:function(){
+return &quot;islice(&quot;+[&quot;...&quot;,_137,stop,step].join(&quot;, &quot;)+&quot;)&quot;;
+},&quot;toString&quot;:MochiKit.Base.forward(&quot;repr&quot;),&quot;next&quot;:function(){
+var rval;
+while(i&lt;_137){
+rval=seq.next();
+i++;
+}
+if(_137&gt;=stop){
+throw MochiKit.Iter.StopIteration;
+}
+_137+=step;
+return rval;
+}};
+};
+MochiKit.Iter.imap=function(fun,p,q){
+var map=MochiKit.Base.map;
+var _141=map(MochiKit.Iter.iter,MochiKit.Base.extend(null,arguments,1));
+var next=MochiKit.Iter.next;
+return {&quot;repr&quot;:function(){
+return &quot;imap(...)&quot;;
+},&quot;toString&quot;:MochiKit.Base.forward(&quot;repr&quot;),&quot;next&quot;:function(){
+return fun.apply(this,map(next,_141));
+}};
+};
+MochiKit.Iter.applymap=function(fun,seq,self){
+seq=MochiKit.Iter.iter(seq);
+return {&quot;repr&quot;:function(){
+return &quot;applymap(...)&quot;;
+},&quot;toString&quot;:MochiKit.Base.forward(&quot;repr&quot;),&quot;next&quot;:function(){
+return fun.apply(self,seq.next());
+}};
+};
+MochiKit.Iter.chain=function(p,q){
+var iter=MochiKit.Iter.iter;
+if(arguments.length==1){
+return iter(arguments[0]);
+}
+var _143=MochiKit.Base.map(iter,arguments);
+var bind=MochiKit.Base.bind;
+return {&quot;repr&quot;:function(){
+return &quot;chain(...)&quot;;
+},&quot;toString&quot;:MochiKit.Base.forward(&quot;repr&quot;),&quot;next&quot;:function(){
+while(_143.length&gt;1){
+try{
+return _143[0].next();
+}
+catch(e){
+if(e!=MochiKit.Iter.StopIteration){
+throw e;
+}
+_143.shift();
+}
+}
+if(_143.length==1){
+var arg=_143.shift();
+this.next=bind(arg.next,arg);
+return this.next();
+}
+throw MochiKit.Iter.StopIteration;
+}};
+};
+MochiKit.Iter.takewhile=function(pred,seq){
+seq=MochiKit.Iter.iter(seq);
+return {&quot;repr&quot;:function(){
+return &quot;takewhile(...)&quot;;
+},&quot;toString&quot;:MochiKit.Base.forward(&quot;repr&quot;),&quot;next&quot;:function(){
+var rval=seq.next();
+if(!pred(rval)){
+this.next=function(){
+throw MochiKit.Iter.StopIteration;
+};
+throw MochiKit.Iter.StopIteration;
+}
+return rval;
+}};
+};
+MochiKit.Iter.dropwhile=function(pred,seq){
+seq=MochiKit.Iter.iter(seq);
+var bind=MochiKit.Base.bind;
+return {&quot;repr&quot;:function(){
+return &quot;dropwhile(...)&quot;;
+},&quot;toString&quot;:MochiKit.Base.forward(&quot;repr&quot;),&quot;next&quot;:function(){
+while(true){
+var rval=seq.next();
+if(!pred(rval)){
+break;
+}
+}
+this.next=bind(seq.next,seq);
+return rval;
+}};
+};
+MochiKit.Iter._tee=function(_145,sync,_147){
+sync.pos[_145]=-1;
+var _148=MochiKit.Base.listMin;
+return {&quot;repr&quot;:function(){
+return &quot;tee(&quot;+_145+&quot;, ...)&quot;;
+},&quot;toString&quot;:MochiKit.Base.forward(&quot;repr&quot;),&quot;next&quot;:function(){
+var rval;
+var i=sync.pos[_145];
+if(i==sync.max){
+rval=_147.next();
+sync.deque.push(rval);
+sync.max+=1;
+sync.pos[_145]+=1;
+}else{
+rval=sync.deque[i-sync.min];
+sync.pos[_145]+=1;
+if(i==sync.min&amp;&amp;_148(sync.pos)!=sync.min){
+sync.min+=1;
+sync.deque.shift();
+}
+}
+return rval;
+}};
+};
+MochiKit.Iter.tee=function(_149,n){
+var rval=[];
+var sync={&quot;pos&quot;:[],&quot;deque&quot;:[],&quot;max&quot;:-1,&quot;min&quot;:-1};
+if(arguments.length==1){
+n=2;
+}
+_149=MochiKit.Iter.iter(_149);
+var _tee=MochiKit.Iter._tee;
+for(var i=0;i&lt;n;i++){
+rval.push(_tee(i,sync,_149));
+}
+return rval;
+};
+MochiKit.Iter.list=function(_151){
+if(typeof (_151.slice)==&quot;function&quot;){
+return _151.slice();
+}else{
+if(MochiKit.Base.isArrayLike(_151)){
+return MochiKit.Base.concat(_151);
+}
+}
+_151=MochiKit.Iter.iter(_151);
+var rval=[];
+try{
+while(true){
+rval.push(_151.next());
+}
+}
+catch(e){
+if(e!=MochiKit.Iter.StopIteration){
+throw e;
+}
+return rval;
+}
+return undefined;
+};
+MochiKit.Iter.reduce=function(fn,_152,_153){
+var i=0;
+var x=_153;
+_152=MochiKit.Iter.iter(_152);
+if(arguments.length&lt;3){
+try{
+x=_152.next();
+}
+catch(e){
+if(e==MochiKit.Iter.StopIteration){
+e=new TypeError(&quot;reduce() of empty sequence with no initial value&quot;);
+}
+throw e;
+}
+i++;
+}
+try{
+while(true){
+x=fn(x,_152.next());
+}
+}
+catch(e){
+if(e!=MochiKit.Iter.StopIteration){
+throw e;
+}
+}
+return x;
+};
+MochiKit.Iter.range=function(){
+var _155=0;
+var stop=0;
+var step=1;
+if(arguments.length==1){
+stop=arguments[0];
+}else{
+if(arguments.length==2){
+_155=arguments[0];
+stop=arguments[1];
+}else{
+if(arguments.length==3){
+_155=arguments[0];
+stop=arguments[1];
+step=arguments[2];
+}else{
+throw TypeError(&quot;range() takes 1, 2, or 3 arguments!&quot;);
+}
+}
+}
+return {&quot;next&quot;:function(){
+if(_155&gt;=stop){
+throw MochiKit.Iter.StopIteration;
+}
+var rval=_155;
+_155+=step;
+return rval;
+},&quot;repr&quot;:function(){
+return &quot;range(&quot;+[_155,stop,step].join(&quot;, &quot;)+&quot;)&quot;;
+},&quot;toString&quot;:MochiKit.Base.forward(&quot;repr&quot;)};
+};
+MochiKit.Iter.sum=function(_156,_157){
+var x=_157?_157:0;
+_156=MochiKit.Iter.iter(_156);
+try{
+while(true){
+x+=_156.next();
+}
+}
+catch(e){
+if(e!=MochiKit.Iter.StopIteration){
+throw e;
+}
+}
+return x;
+};
+MochiKit.Iter.exhaust=function(_158){
+_158=MochiKit.Iter.iter(_158);
+try{
+while(true){
+_158.next();
+}
+}
+catch(e){
+if(e!=MochiKit.Iter.StopIteration){
+throw e;
+}
+}
+};
+MochiKit.Iter.forEach=function(_159,func,self){
+if(arguments.length&gt;2){
+func=MochiKit.Base.bind(func,self);
+}
+if(MochiKit.Base.isArrayLike(_159)){
+for(var i=0;i&lt;_159.length;i++){
+func(_159[i]);
+}
+}else{
+MochiKit.Iter.exhaust(MochiKit.Iter.imap(func,_159));
+}
+};
+MochiKit.Iter.every=function(_161,func){
+try{
+MochiKit.Iter.ifilterfalse(func,_161).next();
+return false;
+}
+catch(e){
+if(e!=MochiKit.Iter.StopIteration){
+throw e;
+}
+return true;
+}
+};
+MochiKit.Iter.sorted=function(_162,cmp){
+var rval=MochiKit.Iter.list(_162);
+if(arguments.length==1){
+cmp=MochiKit.Base.compare;
+}
+rval.sort(cmp);
+return rval;
+};
+MochiKit.Iter.reversed=function(_163){
+var rval=MochiKit.Iter.list(_163);
+rval.reverse();
+return rval;
+};
+MochiKit.Iter.some=function(_164,func){
+try{
+MochiKit.Iter.ifilter(func,_164).next();
+return true;
+}
+catch(e){
+if(e!=MochiKit.Iter.StopIteration){
+throw e;
+}
+return false;
+}
+};
+MochiKit.Iter.iextend=function(lst,_165){
+if(MochiKit.Base.isArrayLike(_165)){
+for(var i=0;i&lt;_165.length;i++){
+lst.push(_165[i]);
+}
+}else{
+_165=MochiKit.Iter.iter(_165);
+try{
+while(true){
+lst.push(_165.next());
+}
+}
+catch(e){
+if(e!=MochiKit.Iter.StopIteration){
+throw e;
+}
+}
+}
+return lst;
+};
+MochiKit.Iter.arrayLikeIter=function(_166){
+var i=0;
+return {&quot;repr&quot;:function(){
+return &quot;arrayLikeIter(...)&quot;;
+},&quot;toString&quot;:MochiKit.Base.forward(&quot;repr&quot;),&quot;next&quot;:function(){
+if(i&gt;=_166.length){
+throw MochiKit.Iter.StopIteration;
+}
+return _166[i++];
+}};
+};
+MochiKit.Iter.EXPORT_OK=[&quot;iteratorRegistry&quot;,&quot;arrayLikeIter&quot;];
+MochiKit.Iter.EXPORT=[&quot;StopIteration&quot;,&quot;registerIteratorFactory&quot;,&quot;iter&quot;,&quot;count&quot;,&quot;cycle&quot;,&quot;repeat&quot;,&quot;next&quot;,&quot;izip&quot;,&quot;ifilter&quot;,&quot;ifilterfalse&quot;,&quot;islice&quot;,&quot;imap&quot;,&quot;applymap&quot;,&quot;chain&quot;,&quot;takewhile&quot;,&quot;dropwhile&quot;,&quot;tee&quot;,&quot;list&quot;,&quot;reduce&quot;,&quot;range&quot;,&quot;sum&quot;,&quot;exhaust&quot;,&quot;forEach&quot;,&quot;every&quot;,&quot;sorted&quot;,&quot;reversed&quot;,&quot;some&quot;,&quot;iextend&quot;];
+MochiKit.Iter.__new__=function(){
+this.StopIteration=new MochiKit.Base.NamedError(&quot;StopIteration&quot;);
+this.iteratorRegistry=new MochiKit.Base.AdapterRegistry();
+this.registerIteratorFactory(&quot;arrayLike&quot;,MochiKit.Base.isArrayLike,this.arrayLikeIter);
+this.EXPORT_TAGS={&quot;:common&quot;:this.EXPORT,&quot;:all&quot;:MochiKit.Base.concat(this.EXPORT,this.EXPORT_OK)};
+MochiKit.Base.nameFunctions(this);
+};
+MochiKit.Iter.__new__();
+reduce=MochiKit.Iter.reduce;
+if((typeof (JSAN)==&quot;undefined&quot;&amp;&amp;typeof (dojo)==&quot;undefined&quot;)||(typeof (MochiKit.__compat__)==&quot;boolean&quot;&amp;&amp;MochiKit.__compat__)){
+(function(self){
+var all=self.EXPORT_TAGS[&quot;:all&quot;];
+for(var i=0;i&lt;all.length;i++){
+this[all[i]]=self[all[i]];
+}
+})(MochiKit.Iter);
+}
+if(typeof (dojo)!=&quot;undefined&quot;){
+dojo.provide(&quot;MochiKit.Logging&quot;);
+dojo.require(&quot;MochiKit.Base&quot;);
+}
+if(typeof (JSAN)!=&quot;undefined&quot;){
+JSAN.use(&quot;MochiKit.Base&quot;,[]);
+}
+try{
+if(typeof (MochiKit.Base)==&quot;undefined&quot;){
+throw &quot;&quot;;
+}
+}
+catch(e){
+throw &quot;MochiKit.Logging depends on MochiKit.Base!&quot;;
+}
+if(typeof (MochiKit.Logging)==&quot;undefined&quot;){
+MochiKit.Logging={};
+}
+MochiKit.Logging.NAME=&quot;MochiKit.Logging&quot;;
+MochiKit.Logging.VERSION=&quot;1.0&quot;;
+MochiKit.Logging.__repr__=function(){
+return &quot;[&quot;+this.NAME+&quot; &quot;+this.VERSION+&quot;]&quot;;
+};
+MochiKit.Logging.toString=function(){
+return this.__repr__();
+};
+MochiKit.Logging.EXPORT=[&quot;LogLevel&quot;,&quot;LogMessage&quot;,&quot;Logger&quot;,&quot;alertListener&quot;,&quot;logger&quot;,&quot;log&quot;,&quot;logError&quot;,&quot;logDebug&quot;,&quot;logFatal&quot;,&quot;logWarning&quot;];
+MochiKit.Logging.EXPORT_OK=[&quot;logLevelAtLeast&quot;,&quot;isLogMessage&quot;,&quot;compareLogMessage&quot;];
+MochiKit.Logging.logLevelAtLeast=function(_167){
+if(typeof (_167)==&quot;string&quot;){
+_167=MochiKit.Logging.LogLevel[_167];
+}
+return function(msg){
+var _169=msg.level;
+if(typeof (_169)==&quot;string&quot;){
+_169=MochiKit.Logging.LogLevel[_169];
+}
+return _169&gt;=_167;
+};
+};
+MochiKit.Logging.LogMessage=function(num,_171,info){
+this.num=num;
+this.level=_171;
+this.info=info;
+this.timestamp=new Date();
+};
+MochiKit.Logging.LogMessage.prototype.repr=function(){
+return &quot;LogMessage(&quot;+MochiKit.Base.map(MochiKit.Base.repr,[this.num,this.level,this.info]).join(&quot;, &quot;)+&quot;)&quot;;
+};
+MochiKit.Logging.LogMessage.prototype.toString=function(){
+return this.repr();
+};
+MochiKit.Logging.isLogMessage=function(){
+var _173=MochiKit.Logging.LogMessage;
+for(var i=0;i&lt;arguments.length;i++){
+if(!(arguments[i] instanceof _173)){
+return false;
+}
+}
+return true;
+};
+MochiKit.Logging.compareLogMessage=function(a,b){
+return MochiKit.Base.compare([a.level,a.info],[b.level,b.info]);
+};
+MochiKit.Logging.Logger=function(_174){
+this.counter=0;
+if(typeof (_174)==&quot;undefined&quot;||_174==null){
+_174=-1;
+}
+this.maxSize=_174;
+this._messages=[];
+this.listeners={};
+};
+MochiKit.Logging.Logger.prototype.clear=function(){
+this._messages.splice(0,this._messages.length);
+};
+MochiKit.Logging.Logger.prototype.dispatchListeners=function(msg){
+for(var k in this.listeners){
+var pair=this.listeners[k];
+if(pair[0]&amp;&amp;!pair[0](msg)){
+continue;
+}
+pair[1](msg);
+}
+};
+MochiKit.Logging.Logger.prototype.addListener=function(_175,_176,_177){
+if(typeof (_176)==&quot;string&quot;){
+_176=MochiKit.Logging.logLevelAtLeast(_176);
+}
+this.listeners[_175]=[_176,_177];
+};
+MochiKit.Logging.Logger.prototype.removeListener=function(_178){
+delete this.listeners[_178];
+};
+MochiKit.Logging.Logger.prototype.baseLog=function(_179,_180){
+var msg=new MochiKit.Logging.LogMessage(this.counter,_179,MochiKit.Base.extend(null,arguments,1));
+this._messages.push(msg);
+this.dispatchListeners(msg);
+this.counter+=1;
+while(this.maxSize&gt;=0&amp;&amp;this._messages.length&gt;this.maxSize){
+this._messges.shift();
+}
+};
+MochiKit.Logging.Logger.prototype.getMessages=function(_181){
+var _182=0;
+if(!(typeof (_181)==&quot;undefined&quot;||_181==null)){
+_182=Math.max(0,this._messages.length-_181);
+}
+return this._messages.slice(_182);
+};
+MochiKit.Logging.Logger.prototype.getMessageText=function(_183){
+if(typeof (_183)==&quot;undefined&quot;||_183==null){
+_183=30;
+}
+var _184=this.getMessages(_183);
+if(_184.length){
+var lst=map(function(m){
+return &quot;\n  [&quot;+m.num+&quot;] &quot;+m.level+&quot;: &quot;+m.info.join(&quot; &quot;);
+},_184);
+lst.unshift(&quot;LAST &quot;+_184.length+&quot; MESSAGES:&quot;);
+return lst.join(&quot;&quot;);
+}
+return &quot;&quot;;
+};
+MochiKit.Logging.Logger.prototype.debuggingBookmarklet=function(_186){
+if(typeof (MochiKit.LoggingPane)==&quot;undefined&quot;){
+alert(this.getMessageText());
+}else{
+MochiKit.LoggingPane.createLoggingPane(_186||false);
+}
+};
+MochiKit.Logging.alertListener=function(msg){
+alert(&quot;num: &quot;+msg.num+&quot;\nlevel: &quot;+msg.level+&quot;\ninfo: &quot;+msg.info.join(&quot; &quot;));
+};
+MochiKit.Logging.__new__=function(){
+this.LogLevel={&quot;ERROR&quot;:40,&quot;FATAL&quot;:50,&quot;WARNING&quot;:30,&quot;INFO&quot;:20,&quot;DEBUG&quot;:10};
+MochiKit.Base.registerComparator(&quot;LogMessage&quot;,this.isLogMessage,this.compareLogMessage);
+var _187=MochiKit.Base.partial;
+var _188=this.Logger;
+_188.prototype.debug=_187(_188.prototype.baseLog,&quot;DEBUG&quot;);
+_188.prototype.log=_187(_188.prototype.baseLog,&quot;INFO&quot;);
+_188.prototype.error=_187(_188.prototype.baseLog,&quot;ERROR&quot;);
+_188.prototype.fatal=_187(_188.prototype.baseLog,&quot;FATAL&quot;);
+_188.prototype.warning=_187(_188.prototype.baseLog,&quot;WARNING&quot;);
+var self=this;
+var _189=function(name){
+return function(){
+self.logger[name].apply(self.logger,arguments);
+};
+};
+this.log=_189(&quot;log&quot;);
+this.logError=_189(&quot;error&quot;);
+this.logDebug=_189(&quot;debug&quot;);
+this.logFatal=_189(&quot;fatal&quot;);
+this.logWarning=_189(&quot;warning&quot;);
+this.logger=new _188();
+this.EXPORT_TAGS={&quot;:common&quot;:this.EXPORT,&quot;:all&quot;:MochiKit.Base.concat(this.EXPORT,this.EXPORT_OK)};
+MochiKit.Base.nameFunctions(this);
+};
+MochiKit.Logging.__new__();
+if((typeof (JSAN)==&quot;undefined&quot;&amp;&amp;typeof (dojo)==&quot;undefined&quot;)||(typeof (MochiKit.__compat__)==&quot;boolean&quot;&amp;&amp;MochiKit.__compat__)){
+(function(self){
+var all=self.EXPORT_TAGS[&quot;:all&quot;];
+for(var i=0;i&lt;all.length;i++){
+this[all[i]]=self[all[i]];
+}
+})(MochiKit.Logging);
+}
+if(typeof (dojo)!=&quot;undefined&quot;){
+dojo.provide(&quot;MochiKit.DateTime&quot;);
+}
+if(typeof (MochiKit)==&quot;undefined&quot;){
+MochiKit={};
+}
+if(typeof (MochiKit.DateTime)==&quot;undefined&quot;){
+MochiKit.DateTime={};
+}
+MochiKit.DateTime.NAME=&quot;MochiKit.DateTime&quot;;
+MochiKit.DateTime.VERSION=&quot;1.0&quot;;
+MochiKit.DateTime.__repr__=function(){
+return &quot;[&quot;+this.NAME+&quot; &quot;+this.VERSION+&quot;]&quot;;
+};
+MochiKit.DateTime.toString=function(){
+return this.__repr__();
+};
+MochiKit.DateTime.isoDate=function(str){
+str=str+&quot;&quot;;
+if(typeof (str)!=&quot;string&quot;||str.length==0){
+return null;
+}
+var iso=str.split(&quot;-&quot;);
+if(iso.length==0){
+return null;
+}
+return new Date(iso[0],iso[1]-1,iso[2]);
+};
+MochiKit.DateTime._isoRegexp=/(\d{4,})(?:-(\d{1,2})(?:-(\d{1,2})(?:[T ](\d{1,2}):(\d{1,2})(?::(\d{1,2})(?:\.(\d+))?)?(?:(Z)|([+-])(\d{1,2})(?::(\d{1,2}))?)?)?)?)?/;
+MochiKit.DateTime.isoTimestamp=function(str){
+str=str+&quot;&quot;;
+if(typeof (str)!=&quot;string&quot;||str.length==0){
+return null;
+}
+var res=str.match(MochiKit.DateTime._isoRegexp);
+if(typeof (res)==&quot;undefined&quot;||res==null){
+return null;
+}
+var year,month,day,hour,min,sec,msec;
+year=parseInt(res[1],10);
+if(typeof (res[2])==&quot;undefined&quot;||res[2]==&quot;&quot;){
+return new Date(year);
+}
+month=parseInt(res[2],10)-1;
+day=parseInt(res[3],10);
+if(typeof (res[4])==&quot;undefined&quot;||res[4]==&quot;&quot;){
+return new Date(year,month,day);
+}
+hour=parseInt(res[4],10);
+min=parseInt(res[5],10);
+sec=(typeof (res[6])!=&quot;undefined&quot;&amp;&amp;res[6]!=&quot;&quot;)?parseInt(res[6],10):0;
+if(typeof (res[7])!=&quot;undefined&quot;&amp;&amp;res[7]!=&quot;&quot;){
+msec=Math.round(1000*parseFloat(&quot;0.&quot;+res[7]));
+}else{
+msec=0;
+}
+if((typeof (res[8])==&quot;undefined&quot;||res[8]==&quot;&quot;)&amp;&amp;(typeof (res[9])==&quot;undefined&quot;||res[9]==&quot;&quot;)){
+return new Date(year,month,day,hour,min,sec,msec);
+}
+var ofs;
+if(typeof (res[9])!=&quot;undefined&quot;&amp;&amp;res[9]!=&quot;&quot;){
+ofs=parseInt(res[10],10)*3600;
+if(typeof (res[11])!=&quot;undefined&quot;&amp;&amp;res[11]!=&quot;&quot;){
+ofs+=parseInt(res[11],10)*60;
+}
+if(res[9]==&quot;-&quot;){
+ofs=-ofs;
+}
+}else{
+ofs=0;
+}
+return new Date(Date.UTC(year,month,day,hour,min,sec,msec)+ofs);
+};
+MochiKit.DateTime.toISOTime=function(date){
+if(typeof (date)==&quot;undefined&quot;||date==null){
+return null;
+}
+var _195=MochiKit.DateTime._padTwo;
+var hh=date.getHours();
+var mm=date.getMinutes();
+var ss=date.getSeconds();
+var lst=[hh,((mm&lt;10)?&quot;0&quot;+mm:mm),((ss&lt;10)?&quot;0&quot;+ss:ss)];
+return lst.join(&quot;:&quot;);
+};
+MochiKit.DateTime.toISOTimestamp=function(date,_199){
+if(typeof (date)==&quot;undefined&quot;||date==null){
+return null;
+}
+var sep=_199?&quot;T&quot;:&quot; &quot;;
+var foot=_199?&quot;Z&quot;:&quot;&quot;;
+if(_199){
+date=new Date(date.getTime()+(date.getTimezoneOffset()*60000));
+}
+return MochiKit.DateTime.toISODate(date)+sep+MochiKit.DateTime.toISOTime(date)+foot;
+};
+MochiKit.DateTime.toISODate=function(date){
+if(typeof (date)==&quot;undefined&quot;||date==null){
+return null;
+}
+var _202=MochiKit.DateTime._padTwo;
+return [date.getFullYear(),_202(date.getMonth()+1),_202(date.getDate())].join(&quot;-&quot;);
+};
+MochiKit.DateTime.americanDate=function(d){
+d=d+&quot;&quot;;
+if(typeof (d)!=&quot;string&quot;||d.length==0){
+return null;
+}
+var a=d.split(&quot;/&quot;);
+return new Date(a[2],a[0]-1,a[1]);
+};
+MochiKit.DateTime._padTwo=function(n){
+return (n&gt;9)?n:&quot;0&quot;+n;
+};
+MochiKit.DateTime.toPaddedAmericanDate=function(d){
+if(typeof (d)==&quot;undefined&quot;||d==null){
+return null;
+}
+var _204=MochiKit.DateTime._padTwo;
+return [_204(d.getMonth()+1),_204(d.getDate()),d.getFullYear()].join(&quot;/&quot;);
+};
+MochiKit.DateTime.toAmericanDate=function(d){
+if(typeof (d)==&quot;undefined&quot;||d==null){
+return null;
+}
+return [d.getMonth()+1,d.getDate(),d.getFullYear()].join(&quot;/&quot;);
+};
+MochiKit.DateTime.EXPORT=[&quot;isoDate&quot;,&quot;isoTimestamp&quot;,&quot;toISOTime&quot;,&quot;toISOTimestamp&quot;,&quot;toISODate&quot;,&quot;americanDate&quot;,&quot;toPaddedAmericanDate&quot;,&quot;toAmericanDate&quot;];
+MochiKit.DateTime.EXPORT_OK=[];
+MochiKit.DateTime.EXPORT_TAGS={&quot;:common&quot;:MochiKit.DateTime.EXPORT,&quot;:all&quot;:MochiKit.DateTime.EXPORT};
+MochiKit.DateTime.__new__=function(){
+var base=this.NAME+&quot;.&quot;;
+for(var k in this){
+var o=this[k];
+if(typeof (o)==&quot;function&quot;&amp;&amp;typeof (o.NAME)==&quot;undefined&quot;){
+try{
+o.NAME=base+k;
+}
+catch(e){
+}
+}
+}
+};
+MochiKit.DateTime.__new__();
+if((typeof (JSAN)==&quot;undefined&quot;&amp;&amp;typeof (dojo)==&quot;undefined&quot;)||(typeof (MochiKit.__compat__)==&quot;boolean&quot;&amp;&amp;MochiKit.__compat__)){
+(function(self){
+var all=self.EXPORT_TAGS[&quot;:all&quot;];
+for(var i=0;i&lt;all.length;i++){
+this[all[i]]=self[all[i]];
+}
+})(MochiKit.DateTime);
+}
+if(typeof (dojo)!=&quot;undefined&quot;){
+dojo.provide(&quot;MochiKit.Format&quot;);
+}
+if(typeof (MochiKit)==&quot;undefined&quot;){
+MochiKit={};
+}
+if(typeof (MochiKit.Format)==&quot;undefined&quot;){
+MochiKit.Format={};
+}
+MochiKit.Format.NAME=&quot;MochiKit.Format&quot;;
+MochiKit.Format.VERSION=&quot;1.0&quot;;
+MochiKit.Format.__repr__=function(){
+return &quot;[&quot;+this.NAME+&quot; &quot;+this.VERSION+&quot;]&quot;;
+};
+MochiKit.Format.toString=function(){
+return this.__repr__();
+};
+MochiKit.Format._numberFormatter=function(_205,_206,_207,_208,_209,_210,_211,_212,_213){
+return function(num){
+num=parseFloat(num);
+if(typeof (num)==&quot;undefined&quot;||num==null||isNaN(num)){
+return _205;
+}
+var _214=_206;
+var _215=_207;
+if(num&lt;0){
+num=-num;
+}else{
+_214=_214.replace(/-/,&quot;&quot;);
+}
+var me=arguments.callee;
+var fmt=MochiKit.Format.formatLocale(_208);
+if(_209){
+num=num*100;
+_215=fmt.percent+_215;
+}
+num=MochiKit.Format.roundToFixed(num,_210);
+var _217=num.split(/\./);
+var _218=_217[0];
+var frac=(_217.length==1)?&quot;&quot;:_217[1];
+var res=&quot;&quot;;
+while(_218.length&lt;_211){
+_218=&quot;0&quot;+_218;
+}
+if(_212){
+while(_218.length&gt;_212){
+var i=_218.length-_212;
+res=res+fmt.separator+_218.substring(i,_218.length);
+_218=_218.substring(0,i);
+}
+}
+res=_218+res;
+if(_210&gt;0){
+while(frac.length&lt;_213){
+frac=frac+&quot;0&quot;;
+}
+res=res+fmt.decimal+frac;
+}
+return _214+res+_215;
+};
+};
+MochiKit.Format.numberFormatter=function(_220,_221,_222){
+if(typeof (_221)==&quot;undefined&quot;){
+_221=&quot;&quot;;
+}
+var _223=_220.match(/((?:[0#]+,)?[0#]+)(?:\.([0#]+))?(%)?/);
+if(!_223){
+throw TypeError(&quot;Invalid pattern&quot;);
+}
+var _224=_220.substr(0,_223.index);
+var _225=_220.substr(_223.index+_223[0].length);
+if(_224.search(/-/)==-1){
+_224=_224+&quot;-&quot;;
+}
+var _226=_223[1];
+var frac=(typeof (_223[2])==&quot;string&quot;&amp;&amp;_223[2]!=&quot;&quot;)?_223[2]:&quot;&quot;;
+var _227=(typeof (_223[3])==&quot;string&quot;&amp;&amp;_223[3]!=&quot;&quot;);
+var tmp=_226.split(/,/);
+var _229;
+if(typeof (_222)==&quot;undefined&quot;){
+_222=&quot;default&quot;;
+}
+if(tmp.length==1){
+_229=null;
+}else{
+_229=tmp[1].length;
+}
+var _230=_226.length-_226.replace(/0/g,&quot;&quot;).length;
+var _231=frac.length-frac.replace(/0/g,&quot;&quot;).length;
+var _232=frac.length;
+return MochiKit.Format._numberFormatter(_221,_224,_225,_222,_227,_232,_230,_229,_231);
+};
+MochiKit.Format.formatLocale=function(_233){
+if(typeof (_233)==&quot;undefined&quot;||_233==null){
+_233=&quot;default&quot;;
+}
+if(typeof (_233)==&quot;string&quot;){
+var rval=MochiKit.Format.LOCALE[_233];
+if(typeof (rval)==&quot;string&quot;){
+rval=arguments.callee(rval);
+MochiKit.Format.LOCALE[_233]=rval;
+}
+return rval;
+}else{
+return _233;
+}
+};
+MochiKit.Format.twoDigitAverage=function(_234,_235){
+if(_235){
+var res=_234/_235;
+if(!isNaN(res)){
+return MochiKit.Format.twoDigitFloat(_234/_235);
+}
+}
+return &quot;0&quot;;
+};
+MochiKit.Format.twoDigitFloat=function(_236){
+var sign=(_236&lt;0?&quot;-&quot;:&quot;&quot;);
+var s=Math.floor(Math.abs(_236)*100).toString();
+if(s==&quot;0&quot;){
+return s;
+}
+if(s.length&lt;3){
+while(s.charAt(s.length-1)==&quot;0&quot;){
+s=s.substring(0,s.length-1);
+}
+return sign+&quot;0.&quot;+s;
+}
+var head=sign+s.substring(0,s.length-2);
+var tail=s.substring(s.length-2,s.length);
+if(tail==&quot;00&quot;){
+return head;
+}else{
+if(tail.charAt(1)==&quot;0&quot;){
+return head+&quot;.&quot;+tail.charAt(0);
+}else{
+return head+&quot;.&quot;+tail;
+}
+}
+};
+MochiKit.Format.lstrip=function(str,_241){
+str=str+&quot;&quot;;
+if(typeof (str)!=&quot;string&quot;){
+return null;
+}
+if(!_241){
+return str.replace(/^\s+/,&quot;&quot;);
+}else{
+return str.replace(new RegExp(&quot;^[&quot;+_241+&quot;]+&quot;),&quot;&quot;);
+}
+};
+MochiKit.Format.rstrip=function(str,_242){
+str=str+&quot;&quot;;
+if(typeof (str)!=&quot;string&quot;){
+return null;
+}
+if(!_242){
+return str.replace(/\s+$/,&quot;&quot;);
+}else{
+return str.replace(new RegExp(&quot;[&quot;+_242+&quot;]+$&quot;),&quot;&quot;);
+}
+};
+MochiKit.Format.strip=function(str,_243){
+var self=MochiKit.Format;
+return self.rstrip(self.lstrip(str,_243),_243);
+};
+MochiKit.Format.truncToFixed=function(_244,_245){
+_244=Math.floor(_244*Math.pow(10,_245));
+var res=(_244*Math.pow(10,-_245)).toFixed(_245);
+if(res.charAt(0)==&quot;.&quot;){
+res=&quot;0&quot;+res;
+}
+return res;
+};
+MochiKit.Format.roundToFixed=function(_246,_247){
+return MochiKit.Format.truncToFixed(_246+0.5*Math.pow(10,-_247),_247);
+};
+MochiKit.Format.percentFormat=function(_248){
+return MochiKit.Format.twoDigitFloat(100*_248)+&quot;%&quot;;
+};
+MochiKit.Format.EXPORT=[&quot;truncToFixed&quot;,&quot;roundToFixed&quot;,&quot;numberFormatter&quot;,&quot;formatLocale&quot;,&quot;twoDigitAverage&quot;,&quot;twoDigitFloat&quot;,&quot;percentFormat&quot;,&quot;lstrip&quot;,&quot;rstrip&quot;,&quot;strip&quot;];
+MochiKit.Format.LOCALE={&quot;en_US&quot;:{&quot;separator&quot;:&quot;,&quot;,&quot;decimal&quot;:&quot;.&quot;,&quot;percent&quot;:&quot;%&quot;},&quot;de_DE&quot;:{&quot;separator&quot;:&quot;.&quot;,&quot;decimal&quot;:&quot;,&quot;,&quot;percent&quot;:&quot;%&quot;},&quot;fr_FR&quot;:{&quot;separator&quot;:&quot; &quot;,&quot;decimal&quot;:&quot;,&quot;,&quot;percent&quot;:&quot;%&quot;},&quot;default&quot;:&quot;en_US&quot;};
+MochiKit.Format.EXPORT_OK=[];
+MochiKit.Format.EXPORT_TAGS={&quot;:all&quot;:MochiKit.Format.EXPORT,&quot;:common&quot;:MochiKit.Format.EXPORT};
+MochiKit.Format.__new__=function(){
+var base=this.NAME+&quot;.&quot;;
+for(var k in this){
+var o=this[k];
+if(typeof (o)==&quot;function&quot;&amp;&amp;typeof (o.NAME)==&quot;undefined&quot;){
+try{
+o.NAME=base+k;
+}
+catch(e){
+}
+}
+}
+};
+MochiKit.Format.__new__();
+if((typeof (JSAN)==&quot;undefined&quot;&amp;&amp;typeof (dojo)==&quot;undefined&quot;)||(typeof (MochiKit.__compat__)==&quot;boolean&quot;&amp;&amp;MochiKit.__compat__)){
+(function(self){
+var all=self.EXPORT_TAGS[&quot;:all&quot;];
+for(var i=0;i&lt;all.length;i++){
+this[all[i]]=self[all[i]];
+}
+})(MochiKit.Format);
+}
+if(typeof (dojo)!=&quot;undefined&quot;){
+dojo.provide(&quot;MochiKit.Async&quot;);
+dojo.require(&quot;MochiKit.Base&quot;);
+}
+if(typeof (JSAN)!=&quot;undefined&quot;){
+JSAN.use(&quot;MochiKit.Base&quot;,[]);
+}
+try{
+if(typeof (MochiKit.Base)==&quot;undefined&quot;){
+throw &quot;&quot;;
+}
+}
+catch(e){
+throw &quot;MochiKit.Async depends on MochiKit.Base!&quot;;
+}
+if(typeof (MochiKit.Async)==&quot;undefined&quot;){
+MochiKit.Async={};
+}
+MochiKit.Async.NAME=&quot;MochiKit.Async&quot;;
+MochiKit.Async.VERSION=&quot;1.0&quot;;
+MochiKit.Async.__repr__=function(){
+return &quot;[&quot;+this.NAME+&quot; &quot;+this.VERSION+&quot;]&quot;;
+};
+MochiKit.Async.toString=function(){
+return this.__repr__();
+};
+MochiKit.Async.AlreadyCalledError=function(_249){
+this.deferred=_249;
+};
+MochiKit.Async.AlreadyCalledError.prototype=new MochiKit.Base.NamedError(&quot;MochiKit.Async.AlreadyCalledError&quot;);
+MochiKit.Async.CancelledError=function(_250){
+this.deferred=_250;
+};
+MochiKit.Async.CancelledError.prototype=new MochiKit.Base.NamedError(&quot;MochiKit.Async.CancelledError&quot;);
+MochiKit.Async.BrowserComplianceError=function(msg){
+this.message=msg;
+};
+MochiKit.Async.BrowserComplianceError.prototype=new MochiKit.Base.NamedError(&quot;MochiKit.Async.BrowserComplianceError&quot;);
+MochiKit.Async.GenericError=function(msg){
+this.message=msg;
+};
+MochiKit.Async.GenericError.prototype=new MochiKit.Base.NamedError(&quot;MochiKit.Async.GenericError&quot;);
+MochiKit.Async.XMLHttpRequestError=function(req,msg){
+this.req=req;
+this.message=msg;
+try{
+this.number=req.status;
+}
+catch(e){
+}
+};
+MochiKit.Async.XMLHttpRequestError.prototype=new MochiKit.Base.NamedError(&quot;MochiKit.Async.XMLHttpRequestError&quot;);
+MochiKit.Async.Deferred=function(_252){
+this.chain=[];
+this.id=this._nextId();
+this.fired=-1;
+this.paused=0;
+this.results=[null,null];
+this.canceller=_252;
+this.silentlyCancelled=false;
+};
+MochiKit.Async.Deferred.prototype.repr=function(){
+var _253;
+if(this.fired==-1){
+_253=&quot;unfired&quot;;
+}else{
+if(this.fired==0){
+_253=&quot;success&quot;;
+}else{
+_253=&quot;error&quot;;
+}
+}
+return &quot;Deferred(&quot;+this.id+&quot;, &quot;+_253+&quot;)&quot;;
+};
+MochiKit.Async.Deferred.prototype.toString=MochiKit.Base.forward(&quot;repr&quot;);
+MochiKit.Async.Deferred.prototype._nextId=(function(){
+var x=0;
+return function(){
+return ++x;
+};
+})();
+MochiKit.Async.Deferred.prototype.cancel=function(){
+if(this.fired==-1){
+if(this.canceller){
+this.canceller(this);
+}else{
+this.silentlyCancelled=true;
+}
+if(this.fired==-1){
+this.errback(new MochiKit.Async.CancelledError(this));
+}
+}else{
+if((this.fired==0)&amp;&amp;(this.results[0] instanceof MochiKit.Async.Deferred)){
+this.results[0].cancel();
+}
+}
+};
+MochiKit.Async.Deferred.prototype._pause=function(){
+this.paused++;
+};
+MochiKit.Async.Deferred.prototype._unpause=function(){
+this.paused--;
+if((this.paused==0)&amp;&amp;(this.fired&gt;=0)){
+this._fire();
+}
+};
+MochiKit.Async.Deferred.prototype._continue=function(res){
+this._resback(res);
+this._unpause();
+};
+MochiKit.Async.Deferred.prototype._resback=function(res){
+this.fired=((res instanceof Error)?1:0);
+this.results[this.fired]=res;
+this._fire();
+};
+MochiKit.Async.Deferred.prototype._check=function(){
+if(this.fired!=-1){
+if(!this.silentlyCancelled){
+throw new MochiKit.Async.AlreadyCalledError(this);
+}
+this.silentlyCancelled=false;
+return;
+}
+};
+MochiKit.Async.Deferred.prototype.callback=function(res){
+this._check();
+this._resback(res);
+};
+MochiKit.Async.Deferred.prototype.errback=function(res){
+this._check();
+if(!(res instanceof Error)){
+res=new MochiKit.Async.GenericError(res);
+}
+this._resback(res);
+};
+MochiKit.Async.Deferred.prototype.addBoth=function(fn){
+return this.addCallbacks(fn,fn);
+};
+MochiKit.Async.Deferred.prototype.addCallback=function(fn){
+return this.addCallbacks(fn,null);
+};
+MochiKit.Async.Deferred.prototype.addErrback=function(fn){
+return this.addCallbacks(null,fn);
+};
+MochiKit.Async.Deferred.prototype.addCallbacks=function(cb,eb){
+this.chain.push([cb,eb]);
+if(this.fired&gt;=0){
+this._fire();
+}
+return this;
+};
+MochiKit.Async.Deferred.prototype._fire=function(){
+var _256=this.chain;
+var _257=this.fired;
+var res=this.results[_257];
+var self=this;
+var cb=null;
+while(_256.length&gt;0&amp;&amp;this.paused==0){
+var pair=_256.shift();
+var f=pair[_257];
+if(f==null){
+continue;
+}
+try{
+res=f(res);
+_257=((res instanceof Error)?1:0);
+if(res instanceof MochiKit.Async.Deferred){
+cb=function(res){
+self._continue(res);
+};
+this._pause();
+}
+}
+catch(err){
+_257=1;
+res=err;
+}
+}
+this.fired=_257;
+this.results[_257]=res;
+if(cb&amp;&amp;this.paused){
+res.addBoth(cb);
+}
+};
+MochiKit.Async.evalJSONRequest=function(req){
+return eval(&quot;(&quot;+req.responseText+&quot;)&quot;);
+};
+MochiKit.Async.succeed=function(_259){
+var d=new MochiKit.Async.Deferred();
+d.callback.apply(d,arguments);
+return d;
+};
+MochiKit.Async.fail=function(_260){
+var d=new MochiKit.Async.Deferred();
+d.errback.apply(d,arguments);
+return d;
+};
+MochiKit.Async.getXMLHttpRequest=function(){
+var self=arguments.callee;
+if(!self.XMLHttpRequest){
+var _261=[function(){
+return new XMLHttpRequest();
+},function(){
+return new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);
+},function(){
+return new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);
+},function(){
+return new ActiveXObject(&quot;Msxml2.XMLHTTP.4.0&quot;);
+},function(){
+throw new MochiKit.Async.BrowserComplianceError(&quot;Browser does not support XMLHttpRequest&quot;);
+}];
+for(var i=0;i&lt;_261.length;i++){
+var func=_261[i];
+try{
+self.XMLHttpRequest=func;
+return func();
+}
+catch(e){
+}
+}
+}
+return self.XMLHttpRequest();
+};
+MochiKit.Async.sendXMLHttpRequest=function(req,_262){
+if(typeof (_262)==&quot;undefined&quot;){
+send=null;
+}
+var _263=function(){
+try{
+req.onreadystatechange=null;
+}
+catch(e){
+try{
+req.onreadystatechange=function(){
+};
+}
+catch(e){
+}
+}
+req.abort();
+};
+var d=new MochiKit.Async.Deferred(_263);
+var _264=function(){
+if(req.readyState==4){
+try{
+req.onreadystatechange=null;
+}
+catch(e){
+try{
+req.onreadystatechange=function(){
+};
+}
+catch(e){
+}
+}
+var _265=null;
+try{
+_265=req.status;
+if(!_265&amp;&amp;MochiKit.Base.isNotEmpty(req.responseText)){
+_265=304;
+}
+}
+catch(e){
+}
+if(_265==200||_265==304){
+d.callback(req);
+}else{
+var err=new MochiKit.Async.XMLHttpRequestError(req,&quot;Request failed&quot;);
+if(err.number){
+d.errback(err);
+}else{
+d.errback(err);
+}
+}
+}
+};
+try{
+req.onreadystatechange=_264;
+req.send(_262);
+}
+catch(e){
+try{
+req.onreadystatechange=null;
+}
+catch(ignore){
+}
+d.errback(e);
+}
+return d;
+};
+MochiKit.Async.doSimpleXMLHttpRequest=function(url){
+var req=MochiKit.Async.getXMLHttpRequest();
+req.open(&quot;GET&quot;,url,true);
+return MochiKit.Async.sendXMLHttpRequest(req);
+};
+MochiKit.Async.loadJSONDoc=function(url){
+var d=MochiKit.Async.doSimpleXMLHttpRequest(url);
+d=d.addCallback(MochiKit.Async.evalJSONRequest);
+return d;
+};
+MochiKit.Async.wait=function(_268,_269){
+var d=new MochiKit.Async.Deferred();
+var bind=MochiKit.Base.bind;
+var _270=MochiKit.Base.partial;
+if(typeof (_269)!=&quot;undefined&quot;){
+d.addCallback(function(){
+return _269;
+});
+}
+var _271=setTimeout(bind(d.callback,d),Math.floor(_268*1000));
+d.canceller=function(){
+try{
+clearTimeout(_271);
+}
+catch(e){
+}
+};
+return d;
+};
+MochiKit.Async.callLater=function(_272,func){
+var m=MochiKit.Base;
+var _273=m.partial.apply(null,m.extend(null,arguments,1));
+return MochiKit.Async.wait(_272).addCallback(function(res){
+return _273();
+});
+};
+MochiKit.Async.EXPORT=[&quot;AlreadyCalledError&quot;,&quot;CancelledError&quot;,&quot;BrowserComplianceError&quot;,&quot;GenericError&quot;,&quot;XMLHttpRequestError&quot;,&quot;Deferred&quot;,&quot;succeed&quot;,&quot;fail&quot;,&quot;getXMLHttpRequest&quot;,&quot;doSimpleXMLHttpRequest&quot;,&quot;loadJSONDoc&quot;,&quot;wait&quot;,&quot;callLater&quot;,&quot;sendXMLHttpRequest&quot;];
+MochiKit.Async.EXPORT_OK=[&quot;evalJSONRequest&quot;];
+MochiKit.Async.__new__=function(){
+this.EXPORT_TAGS={&quot;:common&quot;:this.EXPORT,&quot;:all&quot;:MochiKit.Base.concat(this.EXPORT,this.EXPORT_OK)};
+MochiKit.Base.nameFunctions(this);
+};
+MochiKit.Async.__new__();
+if((typeof (JSAN)==&quot;undefined&quot;&amp;&amp;typeof (dojo)==&quot;undefined&quot;)||(typeof (MochiKit.__compat__)==&quot;boolean&quot;&amp;&amp;MochiKit.__compat__)){
+(function(self){
+var all=self.EXPORT_TAGS[&quot;:all&quot;];
+for(var i=0;i&lt;all.length;i++){
+this[all[i]]=self[all[i]];
+}
+})(MochiKit.Async);
+}
+if(typeof (dojo)!=&quot;undefined&quot;){
+dojo.provide(&quot;MochiKit.DOM&quot;);
+dojo.require(&quot;MochiKit.Iter&quot;);
+}
+if(typeof (JSAN)!=&quot;undefined&quot;){
+JSAN.use(&quot;MochiKit.Iter&quot;,[]);
+}
+try{
+if(typeof (MochiKit.Iter)==&quot;undefined&quot;){
+throw &quot;&quot;;
+}
+}
+catch(e){
+throw &quot;MochiKit.DOM depends on MochiKit.Iter!&quot;;
+}
+if(typeof (MochiKit.DOM)==&quot;undefined&quot;){
+MochiKit.DOM={};
+}
+MochiKit.DOM.NAME=&quot;MochiKit.DOM&quot;;
+MochiKit.DOM.VERSION=&quot;1.0&quot;;
+MochiKit.DOM.__repr__=function(){
+return &quot;[&quot;+this.NAME+&quot; &quot;+this.VERSION+&quot;]&quot;;
+};
+MochiKit.DOM.toString=function(){
+return this.__repr__();
+};
+MochiKit.DOM.EXPORT=[&quot;registerDOMConverter&quot;,&quot;coerceToDOM&quot;,&quot;createDOM&quot;,&quot;createDOMFunc&quot;,&quot;updateNodeAttributes&quot;,&quot;appendChildNodes&quot;,&quot;replaceChildNodes&quot;,&quot;swapDOM&quot;,&quot;BUTTON&quot;,&quot;TT&quot;,&quot;PRE&quot;,&quot;H1&quot;,&quot;H2&quot;,&quot;H3&quot;,&quot;BR&quot;,&quot;HR&quot;,&quot;LABEL&quot;,&quot;TEXTAREA&quot;,&quot;FORM&quot;,&quot;P&quot;,&quot;UL&quot;,&quot;OL&quot;,&quot;LI&quot;,&quot;TD&quot;,&quot;TR&quot;,&quot;THEAD&quot;,&quot;TBODY&quot;,&quot;TFOOT&quot;,&quot;TABLE&quot;,&quot;TH&quot;,&quot;INPUT&quot;,&quot;SPAN&quot;,&quot;A&quot;,&quot;DIV&quot;,&quot;IMG&quot;,&quot;getElement&quot;,&quot;$&quot;,&quot;getElementsByTagAndClassName&quot;,&quot;addToCallStack&quot;,&quot;addLoadEvent&quot;,&quot;focusOnLoad&quot;,&quot;setElementClass&quot;,&quot;toggleElementClass&quot;,&quot;addElementClass&quot;,&quot;removeElementClass&quot;,&quot;swapElementClass&quot;,&quot;hasElementClass&quot;,&quot;escapeHTML&quot;,&quot;toHTML&quot;,&quot;emitHTML&quot;,&quot;setDisplayForElement&quot;,&quot;hideElement&quot;,&quot;showElement&quot;,&quot;scrapeText&quot;];
+MochiKit.DOM.EXPORT_OK=[&quot;domConverters&quot;];
+MochiKit.DOM.registerDOMConverter=function(name,_274,wrap,_276){
+MochiKit.DOM.domConverters.register(name,_274,wrap,_276);
+};
+MochiKit.DOM.coerceToDOM=function(node,ctx){
+var iter=MochiKit.Iter.iter;
+var _278=MochiKit.Iter.repeat;
+var imap=MochiKit.Iter.imap;
+var _280=MochiKit.DOM.domConverters;
+var _281=MochiKit.DOM.coerceToDOM;
+var _282=MochiKit.Base.NotFound;
+while(true){
+if(typeof (node)==&quot;undefined&quot;||node==null){
+return null;
+}
+if(typeof (node.nodeType)!=&quot;undefined&quot;&amp;&amp;node.nodeType&gt;0){
+return node;
+}
+if(typeof (node)==&quot;number&quot;||typeof (node)==&quot;bool&quot;){
+node=node.toString();
+}
+if(typeof (node)==&quot;string&quot;){
+return document.createTextNode(node);
+}
+if(typeof (node.toDOM)==&quot;function&quot;){
+node=node.toDOM(ctx);
+continue;
+}
+if(typeof (node)==&quot;function&quot;){
+node=node(ctx);
+continue;
+}
+var _283=null;
+try{
+_283=iter(node);
+}
+catch(e){
+}
+if(_283){
+return imap(_281,_283,_278(ctx));
+}
+try{
+node=_280.match(node,ctx);
+continue;
+}
+catch(e){
+if(e!=_282){
+throw e;
+}
+}
+return document.createTextNode(node.toString());
+}
+return undefined;
+};
+MochiKit.DOM.updateNodeAttributes=function(node,_284){
+var elem=node;
+if(typeof (node)==&quot;string&quot;){
+elem=MochiKit.DOM.getElement(node);
+}
+if(_284){
+var _285=MochiKit.Base.updatetree;
+if(MochiKit.DOM.attributeArray.compliant){
+for(var k in _284){
+var v=_284[k];
+if(typeof (v)==&quot;object&quot;&amp;&amp;typeof (elem[k])==&quot;object&quot;){
+_285(elem[k],v);
+}else{
+if(k.substring(0,2)==&quot;on&quot;){
+if(typeof (v)==&quot;string&quot;){
+v=new Function(v);
+}
+elem[k]=v;
+}else{
+elem.setAttribute(k,v);
+}
+}
+}
+}else{
+var _286={&quot;class&quot;:&quot;className&quot;,&quot;checked&quot;:&quot;defaultChecked&quot;};
+for(k in _284){
+v=_284[k];
+var _287=_286[k];
+if(typeof (_287)==&quot;string&quot;){
+elem[_287]=v;
+}else{
+if(typeof (elem[k])==&quot;object&quot;&amp;&amp;typeof (v)==&quot;object&quot;){
+_285(elem[k],v);
+}else{
+if(k.substring(0,2)==&quot;on&quot;){
+if(typeof (v)==&quot;string&quot;){
+v=new Function(v);
+}
+elem[k]=v;
+}else{
+elem.setAttribute(k,v);
+}
+}
+}
+}
+}
+}
+return elem;
+};
+MochiKit.DOM.appendChildNodes=function(node){
+var elem=node;
+if(typeof (node)==&quot;string&quot;){
+elem=MochiKit.DOM.getElement(node);
+}
+var _288=[MochiKit.DOM.coerceToDOM(MochiKit.Base.extend(null,arguments,1),elem)];
+var _289=MochiKit.Iter.iextend;
+while(_288.length){
+var n=_288.shift();
+if(typeof (n)==&quot;undefined&quot;||n==null){
+}else{
+if(typeof (n.nodeType)==&quot;number&quot;){
+elem.appendChild(n);
+}else{
+_289(_288,n);
+}
+}
+}
+return elem;
+};
+MochiKit.DOM.replaceChildNodes=function(node){
+var elem=node;
+if(typeof (node)==&quot;string&quot;){
+elem=MochiKit.DOM.getElement(node);
+arguments[0]=elem;
+}
+var _290;
+while((_290=elem.firstChild)){
+elem.removeChild(_290);
+}
+if(arguments.length&lt;2){
+return elem;
+}else{
+return MochiKit.DOM.appendChildNodes.apply(this,arguments);
+}
+};
+MochiKit.DOM.createDOM=function(name,_291){
+var elem;
+if(typeof (name)==&quot;string&quot;){
+elem=document.createElement(name);
+}else{
+elem=name;
+}
+if(_291){
+MochiKit.DOM.updateNodeAttributes(elem,_291);
+}
+if(arguments.length&lt;=2){
+return elem;
+}else{
+var args=MochiKit.Base.extend([elem],arguments,2);
+return MochiKit.DOM.appendChildNodes.apply(this,args);
+}
+};
+MochiKit.DOM.createDOMFunc=function(){
+return MochiKit.Base.partial.apply(this,MochiKit.Base.extend([MochiKit.DOM.createDOM],arguments));
+};
+MochiKit.DOM.swapDOM=function(dest,src){
+dest=MochiKit.DOM.getElement(dest);
+var _295=dest.parentNode;
+if(src){
+src=MochiKit.DOM.getElement(src);
+_295.replaceChild(src,dest);
+}else{
+_295.removeChild(dest);
+}
+return src;
+};
+MochiKit.DOM.getElement=function(id){
+if(arguments.length==1){
+return ((typeof (id)==&quot;string&quot;)?document.getElementById(id):id);
+}else{
+return MochiKit.Base.map(getElement,arguments);
+}
+};
+MochiKit.DOM.getElementsByTagAndClassName=function(_297,_298,_299){
+if(typeof (_297)==&quot;undefined&quot;||_297==null){
+_297=&quot;*&quot;;
+}
+if(typeof (_299)==&quot;undefined&quot;||_299==null){
+_299=document;
+}
+_299=MochiKit.DOM.getElement(_299);
+var _300=_299.getElementsByTagName(_297)||document.all;
+if(typeof (_298)==&quot;undefined&quot;||_298==null){
+return MochiKit.Base.extend(null,_300);
+}
+var _301=[];
+for(var i=0;i&lt;_300.length;i++){
+var _302=_300[i];
+var _303=_302.className.split(&quot; &quot;);
+for(var j=0;j&lt;_303.length;j++){
+if(_303[j]==_298){
+_301.push(_302);
+break;
+}
+}
+}
+return _301;
+};
+MochiKit.DOM.addToCallStack=function(_304,path,func,once){
+var _307=_304[path];
+var _308=_307;
+if(!(typeof (_307)==&quot;function&quot;&amp;&amp;_307.callStack)){
+_308=function(){
+var _309=_308.callStack;
+for(var i=0;i&lt;_309.length;i++){
+if(_309[i].apply(this,arguments)===false){
+break;
+}
+}
+if(once){
+try{
+_304[path]=null;
+}
+catch(e){
+}
+}
+};
+_308.callStack=[];
+if(typeof (_307)==&quot;function&quot;){
+_308.callStack.push(_307);
+}
+_304[path]=_308;
+}
+_308.callStack.push(func);
+};
+MochiKit.DOM.addLoadEvent=function(func){
+MochiKit.DOM.addToCallStack(window,&quot;onload&quot;,func,true);
+};
+MochiKit.DOM.focusOnLoad=function(_310){
+MochiKit.DOM.addLoadEvent(function(){
+_310=MochiKit.DOM.getElement(_310);
+if(_310){
+_310.focus();
+}
+});
+};
+MochiKit.DOM.setElementClass=function(_311,_312){
+var obj=MochiKit.DOM.getElement(_311);
+if(MochiKit.DOM.attributeArray.compliant){
+obj.setAttribute(&quot;class&quot;,_312);
+}else{
+obj.setAttribute(&quot;className&quot;,_312);
+}
+};
+MochiKit.DOM.toggleElementClass=function(_313){
+var _314=MochiKit.DOM.getElement;
+var _315=MochiKit.DOM.addElementClass;
+var _316=MochiKit.DOM.removeElementClass;
+for(var i=1;i&lt;arguments.length;i++){
+var obj=_314(arguments[i]);
+if(!_315(obj,_313)){
+_316(obj,_313);
+}
+}
+};
+MochiKit.DOM.addElementClass=function(_317,_318){
+var obj=MochiKit.DOM.getElement(_317);
+var cls=obj.className;
+if(cls.length==0){
+MochiKit.DOM.setElementClass(obj,_318);
+return true;
+}
+if(cls==_318){
+return false;
+}
+var _320=obj.className.split(&quot; &quot;);
+for(var i=0;i&lt;_320.length;i++){
+if(_320[i]==_318){
+return false;
+}
+}
+MochiKit.DOM.setElementClass(obj,cls+&quot; &quot;+_318);
+return true;
+};
+MochiKit.DOM.removeElementClass=function(_321,_322){
+var obj=MochiKit.DOM.getElement(_321);
+var cls=obj.className;
+if(cls.length==0){
+return false;
+}
+if(cls==_322){
+MochiKit.DOM.setElementClass(obj,&quot;&quot;);
+return true;
+}
+var _323=obj.className.split(&quot; &quot;);
+for(var i=0;i&lt;_323.length;i++){
+if(_323[i]==_322){
+_323.splice(i,1);
+MochiKit.DOM.setElementClass(obj,_323.join(&quot; &quot;));
+return true;
+}
+}
+return false;
+};
+MochiKit.DOM.swapElementClass=function(_324,_325,_326){
+var obj=MochiKit.DOM.getElement(_324);
+var res=MochiKit.DOM.removeElementClass(obj,_325);
+if(res){
+MochiKit.DOM.addElementClass(obj,_326);
+}
+return res;
+};
+MochiKit.DOM.hasElementClass=function(_327,_328){
+var obj=MochiKit.DOM.getElement(_327);
+var _329=obj.className.split(&quot; &quot;);
+for(var i=1;i&lt;arguments.length;i++){
+var good=false;
+for(var j=0;j&lt;_329.length;j++){
+if(_329[j]==arguments[i]){
+good=true;
+break;
+}
+}
+if(!good){
+return false;
+}
+}
+return true;
+};
+MochiKit.DOM.escapeHTML=function(s){
+var buf=[];
+var _332=MochiKit.DOM._TRANSTABLE;
+for(var i=0;i&lt;s.length;i++){
+var c=s.charAt(i);
+var o=_332[c];
+if(o){
+c=o;
+}
+buf.push(c);
+}
+return buf.join(&quot;&quot;);
+};
+MochiKit.DOM.toHTML=function(dom){
+return MochiKit.DOM.emitHTML(dom).join(&quot;&quot;);
+};
+MochiKit.DOM.emitHTML=function(dom,lst){
+if(typeof (lst)==&quot;undefined&quot;||lst==null){
+lst=[];
+}
+var _335=[dom];
+var _336=MochiKit.DOM.escapeHTML;
+var _337=MochiKit.DOM.attributeArray;
+while(_335.length){
+dom=_335.pop();
+if(typeof (dom)==&quot;string&quot;){
+lst.push(dom);
+}else{
+if(dom.nodeType==1){
+lst.push(&quot;&lt;&quot;+dom.nodeName.toLowerCase());
+var _338=[];
+var _339=_337(dom);
+for(var i=0;i&lt;_339.length;i++){
+var a=_339[i];
+_338.push([&quot; &quot;,a.name,&quot;=\&quot;&quot;,_336(a.value),&quot;\&quot;&quot;]);
+}
+_338.sort();
+for(i=0;i&lt;_338.length;i++){
+var _340=_338[i];
+for(var j=0;j&lt;_340.length;j++){
+lst.push(_340[j]);
+}
+}
+if(dom.hasChildNodes()){
+lst.push(&quot;&gt;&quot;);
+_335.push(&quot;&lt;/&quot;+dom.nodeName.toLowerCase()+&quot;&gt;&quot;);
+var _341=dom.childNodes;
+for(i=_341.length-1;i&gt;=0;i--){
+_335.push(_341[i]);
+}
+}else{
+lst.push(&quot;/&gt;&quot;);
+}
+}else{
+if(dom.nodeType==3){
+lst.push(_336(dom.nodeValue));
+}
+}
+}
+}
+return lst;
+};
+MochiKit.DOM.setDisplayForElement=function(_342,_343){
+var _344=MochiKit.Base.extend(null,arguments,1);
+MochiKit.Iter.forEach(MochiKit.Base.filter(null,MochiKit.Base.map(getElement,_344)),function(_343){
+_343.style.display=_342;
+});
+};
+MochiKit.DOM.scrapeText=function(node,_345){
+var rval=[];
+MochiKit.Base.nodeWalk(node,function(node){
+var _346=node.nodeValue;
+if(typeof (_346)==&quot;string&quot;){
+rval.push(_346);
+}
+return node.childNodes;
+});
+if(_345){
+return rval;
+}else{
+return rval.join(&quot;&quot;);
+}
+};
+MochiKit.DOM.__new__=function(){
+this.domConverters=new MochiKit.Base.AdapterRegistry();
+var _347=document.createElement(&quot;span&quot;);
+var _348;
+if(_347.attributes.length&gt;0){
+var _349=MochiKit.Base.filter;
+_348=function(node){
+return _349(_348.ignoreAttrFilter,node.attributes);
+};
+_348.ignoreAttr={};
+MochiKit.Iter.forEach(_347.attributes,function(a){
+_348.ignoreAttr[a.name]=a.value;
+});
+_348.ignoreAttrFilter=function(a){
+return (_348.ignoreAttr[a.name]!=a.value);
+};
+_348.compliant=false;
+}else{
+_348=function(node){
+return node.attributes;
+};
+_348.compliant=true;
+}
+this.attributeArray=_348;
+var _350=this.createDOMFunc;
+this.UL=_350(&quot;ul&quot;);
+this.OL=_350(&quot;ol&quot;);
+this.LI=_350(&quot;li&quot;);
+this.TD=_350(&quot;td&quot;);
+this.TR=_350(&quot;tr&quot;);
+this.TBODY=_350(&quot;tbody&quot;);
+this.THEAD=_350(&quot;thead&quot;);
+this.TFOOT=_350(&quot;tfoot&quot;);
+this.TABLE=_350(&quot;table&quot;);
+this.TH=_350(&quot;th&quot;);
+this.INPUT=_350(&quot;input&quot;);
+this.SPAN=_350(&quot;span&quot;);
+this.A=_350(&quot;a&quot;);
+this.DIV=_350(&quot;div&quot;);
+this.IMG=_350(&quot;img&quot;);
+this.BUTTON=_350(&quot;button&quot;);
+this.TT=_350(&quot;tt&quot;);
+this.PRE=_350(&quot;pre&quot;);
+this.H1=_350(&quot;h1&quot;);
+this.H2=_350(&quot;h2&quot;);
+this.H3=_350(&quot;h3&quot;);
+this.BR=_350(&quot;br&quot;);
+this.HR=_350(&quot;hr&quot;);
+this.LABEL=_350(&quot;label&quot;);
+this.TEXTAREA=_350(&quot;textarea&quot;);
+this.FORM=_350(&quot;form&quot;);
+this.P=_350(&quot;p&quot;);
+this._TRANSTABLE={&quot;&lt;&quot;:&quot;&lt;&quot;,&quot;&gt;&quot;:&quot;&gt;&quot;,&quot;&amp;&quot;:&quot;&amp;&quot;,&quot;'&quot;:&quot;&apos;&quot;,&quot;\&quot;&quot;:&quot;&quot;&quot;};
+var _351=MochiKit.Base.partial;
+this.hideElement=_351(this.setDisplayForElement,&quot;none&quot;);
+this.showElement=_351(this.setDisplayForElement,&quot;block&quot;);
+this.$=this.getElement;
+this.EXPORT_TAGS={&quot;:common&quot;:this.EXPORT,&quot;:all&quot;:MochiKit.Base.concat(this.EXPORT,this.EXPORT_OK)};
+MochiKit.Base.nameFunctions(this);
+};
+MochiKit.DOM.__new__();
+if((typeof (JSAN)==&quot;undefined&quot;&amp;&amp;typeof (dojo)==&quot;undefined&quot;)||(typeof (MochiKit.__compat__)==&quot;boolean&quot;&amp;&amp;MochiKit.__compat__)){
+(function(self){
+var all=self.EXPORT_TAGS[&quot;:all&quot;];
+for(var i=0;i&lt;all.length;i++){
+this[all[i]]=self[all[i]];
+}
+})(MochiKit.DOM);
+}
+if(typeof (dojo)!=&quot;undefined&quot;){
+dojo.provide(&quot;MochiKit.LoggingPane&quot;);
+dojo.require(&quot;MochiKit.Logging&quot;);
+dojo.require(&quot;MochiKit.Base&quot;);
+}
+if(typeof (JSAN)!=&quot;undefined&quot;){
+JSAN.use(&quot;MochiKit.Logging&quot;,[]);
+JSAN.use(&quot;MochiKit.Base&quot;,[]);
+}
+try{
+if(typeof (MochiKit.Base)==&quot;undefined&quot;||typeof (MochiKit.Logging)==&quot;undefined&quot;){
+throw &quot;&quot;;
+}
+}
+catch(e){
+throw &quot;MochiKit.LoggingPane depends on MochiKit.Base and MochiKit.Logging!&quot;;
+}
+if(typeof (MochiKit.LoggingPane)==&quot;undefined&quot;){
+MochiKit.LoggingPane={};
+}
+MochiKit.LoggingPane.NAME=&quot;MochiKit.LoggingPane&quot;;
+MochiKit.LoggingPane.VERSION=&quot;1.0&quot;;
+MochiKit.LoggingPane.__repr__=function(){
+return &quot;[&quot;+this.NAME+&quot; &quot;+this.VERSION+&quot;]&quot;;
+};
+MochiKit.LoggingPane.toString=function(){
+return this.__repr__();
+};
+MochiKit.LoggingPane.createLoggingPane=function(_352){
+var m=MochiKit.LoggingPane;
+_352=!(!_352);
+if(m._loggingPane&amp;&amp;m._loggingPane.inline!=_352){
+m._loggingPane.closePane();
+m._loggingPane=null;
+}
+if(!m._loggingPane||m._loggingPane.closed){
+m._loggingPane=new m.LoggingPane(_352,MochiKit.Logging.logger);
+}
+return m._loggingPane;
+};
+MochiKit.LoggingPane.LoggingPane=function(_353,_354){
+var doc=document;
+if(typeof (_354)==&quot;undefined&quot;||_354==null){
+MochiKit.Logging.logger;
+}
+var _356=MochiKit.Base.update;
+var _357=MochiKit.Base.updatetree;
+var bind=MochiKit.Base.bind;
+var _358=MochiKit.Base.clone;
+var win;
+if(!_353){
+win=window.open(&quot;&quot;,&quot;&quot;,&quot;dependent,resizable,height=200&quot;);
+if(!win){
+alert(&quot;Not able to open debugging window due to pop-up blocking.&quot;);
+return;
+}
+doc=win.document;
+}
+this.doc=doc;
+var _360=doc.createElement(&quot;div&quot;);
+var _361=doc.createElement(&quot;input&quot;);
+var _362=doc.createElement(&quot;input&quot;);
+var _363=doc.createElement(&quot;button&quot;);
+var _364=doc.createElement(&quot;button&quot;);
+var _365=doc.createElement(&quot;button&quot;);
+var _366=doc.createElement(&quot;button&quot;);
+var _367=doc.createElement(&quot;div&quot;);
+var _368=doc.createElement(&quot;div&quot;);
+var _369=&quot;_debugPaneListener&quot;;
+this.colorTable=_358(this.colorTable);
+var _370=[];
+var _371=null;
+var _372=function(msg){
+var _373=msg.level;
+if(typeof (_373)==&quot;number&quot;){
+_373=MochiKit.Logging.LogLevel[_373];
+}
+return _373;
+};
+var _374=function(msg){
+return msg.info.join(&quot; &quot;);
+};
+var _375=bind(function(msg){
+var _376=_372(msg);
+var text=_374(msg);
+var c=this.colorTable[_376];
+var p=doc.createElement(&quot;span&quot;);
+p.style.color=c;
+p.style.margin=&quot;0&quot;;
+p.appendChild(doc.createTextNode(_376+&quot;: &quot;+text));
+_368.appendChild(p);
+_368.appendChild(doc.createElement(&quot;br&quot;));
+if(_367.offsetHeight&gt;_367.scrollHeight){
+_367.scrollTop=0;
+}else{
+_367.scrollTop=_367.scrollHeight;
+}
+},this);
+var _378=function(msg){
+_370[_370.length]=msg;
+_375(msg);
+};
+var _379=function(){
+var _380,infore;
+try{
+_380=new RegExp(_361.value);
+infore=new RegExp(_362.value);
+}
+catch(e){
+logDebug(&quot;Error in filter regex: &quot;+e.message);
+return null;
+}
+return function(msg){
+return (_380.test(_372(msg))&amp;&amp;infore.test(_374(msg)));
+};
+};
+var _381=function(){
+while(_368.firstChild){
+_368.removeChild(_368.firstChild);
+}
+};
+var _382=function(){
+_370=[];
+_381();
+};
+var _383=bind(function(){
+if(this.closed){
+return;
+}
+this.closed=true;
+if(MochiKit.LoggingPane._loggingPane==this){
+MochiKit.LoggingPane._loggingPane=null;
+}
+_354.removeListener(_369);
+if(_353){
+_360.parentNode.removeChild(_360);
+}else{
+this.win.close();
+}
+},this);
+var _384=function(){
+_381();
+for(var i=0;i&lt;_370.length;i++){
+var msg=_370[i];
+if(_371==null||_371(msg)){
+_375(msg);
+}
+}
+};
+var _385=function(){
+_371=_379();
+_384();
+_354.removeListener(_369);
+_354.addListener(_369,_371,_378);
+};
+var _386=function(){
+_370=_354.getMessages();
+_384();
+};
+var _387=function(_388){
+_388=_388||window.event;
+key=_388.which||_388.keyCode;
+if(key==13){
+_385();
+}
+};
+var _389={&quot;display&quot;:&quot;block&quot;,&quot;position&quot;:&quot;fixed&quot;,&quot;left&quot;:&quot;0px&quot;,&quot;bottom&quot;:&quot;0px&quot;,&quot;font&quot;:this.logFont,&quot;width&quot;:&quot;100%&quot;,&quot;height&quot;:&quot;100%&quot;,&quot;backgroundColor&quot;:&quot;white&quot;};
+if(_353){
+_389.height=&quot;10em&quot;;
+_389.borderTop=&quot;2px solid black&quot;;
+}
+_356(_360.style,_389);
+doc.body.appendChild(_360);
+_389={&quot;width&quot;:&quot;33%&quot;,&quot;display&quot;:&quot;inline&quot;,&quot;font&quot;:this.logFont};
+_357(_361,{&quot;value&quot;:&quot;FATAL|ERROR|WARNING|INFO|DEBUG&quot;,&quot;onkeypress&quot;:_387,&quot;style&quot;:_389});
+_360.appendChild(_361);
+_357(_362,{&quot;value&quot;:&quot;.*&quot;,&quot;onkeypress&quot;:_387,&quot;style&quot;:_389});
+_360.appendChild(_362);
+_389={&quot;width&quot;:&quot;8%&quot;,&quot;display&quot;:&quot;inline&quot;,&quot;font&quot;:this.logFont};
+_363.appendChild(doc.createTextNode(&quot;Filter&quot;));
+_363.onclick=_385;
+_356(_363.style,_389);
+_360.appendChild(_363);
+_364.appendChild(doc.createTextNode(&quot;Load&quot;));
+_364.onclick=_386;
+_356(_364.style,_389);
+_360.appendChild(_364);
+_365.appendChild(doc.createTextNode(&quot;Clear&quot;));
+_365.onclick=_382;
+_356(_365.style,_389);
+_360.appendChild(_365);
+_366.appendChild(doc.createTextNode(&quot;Close&quot;));
+_366.onclick=_383;
+_356(_366.style,_389);
+_360.appendChild(_366);
+_360.style.display=&quot;block&quot;;
+_367.style.overflow=&quot;auto&quot;;
+_367.style.width=&quot;100%&quot;;
+_368.style.whitespace=&quot;preserve&quot;;
+_368.style.width=&quot;100%&quot;;
+_368.style.height=&quot;8em&quot;;
+_367.appendChild(_368);
+_360.appendChild(_367);
+_385();
+_386();
+this.win=win;
+this.inline=_353;
+this.closePane=_383;
+this.closed=false;
+};
+MochiKit.LoggingPane.LoggingPane.prototype={&quot;logFont&quot;:&quot;8pt Verdana,sans-serif&quot;,&quot;colorTable&quot;:{&quot;ERROR&quot;:&quot;red&quot;,&quot;FATAL&quot;:&quot;darkred&quot;,&quot;WARNING&quot;:&quot;blue&quot;,&quot;INFO&quot;:&quot;black&quot;,&quot;DEBUG&quot;:&quot;green&quot;}};
+MochiKit.LoggingPane.EXPORT_OK=[&quot;LoggingPane&quot;];
+MochiKit.LoggingPane.EXPORT=[&quot;createLoggingPane&quot;];
+MochiKit.LoggingPane.__new__=function(){
+this.EXPORT_TAGS={&quot;:common&quot;:this.EXPORT,&quot;:all&quot;:MochiKit.Base.concat(this.EXPORT,this.EXPORT_OK)};
+MochiKit.Base.nameFunctions(this);
+MochiKit.LoggingPane._loggingPane=null;
+};
+MochiKit.LoggingPane.__new__();
+if((typeof (JSAN)==&quot;undefined&quot;&amp;&amp;typeof (dojo)==&quot;undefined&quot;)||(typeof (MochiKit.__compat__)==&quot;boolean&quot;&amp;&amp;MochiKit.__compat__)){
+(function(self){
+var all=self.EXPORT_TAGS[&quot;:all&quot;];
+for(var i=0;i&lt;all.length;i++){
+this[all[i]]=self[all[i]];
+}
+})(MochiKit.LoggingPane);
+}
+if(typeof (dojo)!=&quot;undefined&quot;){
+dojo.provide(&quot;MochiKit.Visual&quot;);
+dojo.require(&quot;MochiKit.Base&quot;);
+dojo.require(&quot;MochiKit.DOM&quot;);
+}
+if(typeof (JSAN)!=&quot;undefined&quot;){
+JSAN.use(&quot;MochiKit.Base&quot;,[]);
+JSAN.use(&quot;MochiKit.DOM&quot;,[]);
+}
+try{
+if(typeof (MochiKit.Base)==&quot;undefined&quot;||typeof (MochiKit.DOM)==&quot;undefined&quot;){
+throw &quot;&quot;;
+}
+}
+catch(e){
+throw &quot;MochiKit.Visual depends on MochiKit.Base and MochiKit.DOM!&quot;;
+}
+if(typeof (MochiKit.Visual)==&quot;undefined&quot;){
+MochiKit.Visual={};
+}
+MochiKit.Visual.NAME=&quot;MochiKit.Visual&quot;;
+MochiKit.Visual.VERSION=&quot;1.0&quot;;
+MochiKit.Visual.__repr__=function(){
+return &quot;[&quot;+this.NAME+&quot; &quot;+this.VERSION+&quot;]&quot;;
+};
+MochiKit.Visual.toString=function(){
+return this.__repr__();
+};
+MochiKit.Visual.clampColorComponent=function(v,_390){
+v*=_390;
+if(v&lt;0){
+return 0;
+}else{
+if(v&gt;_390){
+return _390;
+}else{
+return v;
+}
+}
+};
+MochiKit.Visual.Color=function(red,_392,blue,_394){
+if(typeof (_394)==&quot;undefined&quot;||_394==null){
+_394=1;
+}
+this.rgb={&quot;r&quot;:red,&quot;g&quot;:_392,&quot;b&quot;:blue,&quot;a&quot;:_394};
+};
+MochiKit.Visual.Color.prototype={&quot;__class__&quot;:MochiKit.Visual.Color,&quot;colorWithAlpha&quot;:function(_395){
+var rgb=this.rgb;
+var m=MochiKit.Visual;
+return m.Color.fromRGB(rgb.r,rgb.g,rgb.b,_395);
+},&quot;colorWithHue&quot;:function(hue){
+var hsl=this.asHSL();
+hsl.h=hue;
+var m=MochiKit.Visual;
+return m.Color.fromHSL(hsl);
+},&quot;colorWithSaturation&quot;:function(_399){
+var hsl=this.asHSL();
+hsl.s=_399;
+var m=MochiKit.Visual;
+return m.Color.fromHSL(hsl);
+},&quot;colorWithLightness&quot;:function(_400){
+var hsl=this.asHSL();
+hsl.l=_400;
+var m=MochiKit.Visual;
+return m.Color.fromHSL(hsl);
+},&quot;darkerColorWithLevel&quot;:function(_401){
+var hsl=this.asHSL();
+hsl.l=Math.max(hsl.l-_401,0);
+var m=MochiKit.Visual;
+return m.Color.fromHSL(hsl);
+},&quot;lighterColorWithLevel&quot;:function(_402){
+var hsl=this.asHSL();
+Math.min(hsl.l+_402,1);
+var m=MochiKit.Visual;
+return m.Color.fromHSL(hsl);
+},&quot;blendedColor&quot;:function(_403,_404){
+if(typeof (_404)==&quot;undefined&quot;||_404==null){
+_404=0.5;
+}
+var sf=1-_404;
+var s=this.rgb;
+var d=_403.rgb;
+var df=_404;
+return MochiKit.Visual.Color.fromRGB((s.r*sf)+(d.r*df),(s.g*sf)+(d.g*df),(s.b*sf)+(d.b*df),(s.a*sf)+(d.a*df));
+},&quot;compareRGB&quot;:function(_407){
+var a=this.asRGB();
+var b=_407.asRGB();
+return MochiKit.Base.compare([a.r,a.g,a.b,a.a],[b.r,b.g,b.b,b.a]);
+},&quot;isLight&quot;:function(){
+return this.asHSL().b&gt;0.5;
+},&quot;isDark&quot;:function(){
+return (!this.isLight());
+},&quot;toHSLString&quot;:function(){
+var c=this.asHSL();
+var ccc=MochiKit.Visual.clampColorComponent;
+var rval=this._hslString;
+if(!rval){
+var mid=(ccc(c.h,360).toFixed(0)+&quot;,&quot;+ccc(c.s,100).toPrecision(4)+&quot;%&quot;+&quot;,&quot;+ccc(c.l,100).toPrecision(4)+&quot;%&quot;);
+var a=c.a;
+if(a&gt;=1){
+a=1;
+rval=&quot;hsl(&quot;+mid+&quot;)&quot;;
+}else{
+if(a&lt;=0){
+a=0;
+}
+rval=&quot;hsla(&quot;+mid+&quot;,&quot;+a+&quot;)&quot;;
+}
+this._hslString=rval;
+}
+return rval;
+},&quot;toRGBString&quot;:function(){
+var c=this.rgb;
+var ccc=MochiKit.Visual.clampColorComponent;
+var rval=this._rgbString;
+if(!rval){
+var mid=(ccc(c.r,255).toFixed(0)+&quot;,&quot;+ccc(c.g,255).toFixed(0)+&quot;,&quot;+ccc(c.b,255).toFixed(0));
+if(c.a!=1){
+rval=&quot;rgba(&quot;+mid+&quot;,&quot;+c.a+&quot;)&quot;;
+}else{
+rval=&quot;rgb(&quot;+mid+&quot;)&quot;;
+}
+this._rgbString=rval;
+}
+return rval;
+},&quot;asRGB&quot;:function(){
+return MochiKit.Base.clone(this.rgb);
+},&quot;toHexString&quot;:function(){
+var m=MochiKit.Visual;
+var c=this.rgb;
+var ccc=MochiKit.Visual.clampColorComponent;
+var rval=this._hexString;
+if(!rval){
+rval=(&quot;#&quot;+m.toColorPart(ccc(c.r,255))+m.toColorPart(ccc(c.g,255))+m.toColorPart(ccc(c.b,255)));
+this._hexString=rval;
+}
+return rval;
+},&quot;asHSV&quot;:function(){
+var hsv=this.hsv;
+var c=this.rgb;
+if(typeof (hsv)==&quot;undefined&quot;||hsv==null){
+hsv=MochiKit.Visual.rgbToHSV(this.rgb);
+this.hsv=hsv;
+}
+return MochiKit.Base.clone(hsv);
+},&quot;asHSL&quot;:function(){
+var hsl=this.hsl;
+var c=this.rgb;
+if(typeof (hsl)==&quot;undefined&quot;||hsl==null){
+hsl=MochiKit.Visual.rgbToHSL(this.rgb);
+this.hsl=hsl;
+}
+return MochiKit.Base.clone(hsl);
+},&quot;toString&quot;:function(){
+return this.toRGBString();
+},&quot;repr&quot;:function(){
+var c=this.rgb;
+var col=[c.r,c.g,c.b,c.a];
+return this.__class__.NAME+&quot;(&quot;+col.join(&quot;, &quot;)+&quot;)&quot;;
+}};
+MochiKit.Visual.Color.fromRGB=function(red,_412,blue,_413){
+var _414=MochiKit.Visual.Color;
+if(arguments.length==1){
+var rgb=red;
+red=rgb.r;
+_412=rgb.g;
+blue=rgb.b;
+if(typeof (rgb.a)==&quot;undefined&quot;){
+_413=undefined;
+}else{
+_413=rgb.a;
+}
+}
+return new _414(red,_412,blue,_413);
+};
+MochiKit.Visual.Color.fromHSL=function(hue,_415,_416,_417){
+var m=MochiKit.Visual;
+return m.Color.fromRGB(m.hslToRGB.apply(m,arguments));
+};
+MochiKit.Visual.Color.fromHSV=function(hue,_418,_419,_420){
+var m=MochiKit.Visual;
+return m.Color.fromRGB(m.hsvToRGB.apply(m,arguments));
+};
+MochiKit.Visual.Color.fromName=function(name){
+var _421=MochiKit.Visual.Color;
+var _422=_421._namedColors[name.toLowerCase()];
+if(typeof (_422)==&quot;string&quot;){
+return _421.fromHexString(_422);
+}else{
+if(name==&quot;transparent&quot;){
+return _421.transparentColor();
+}
+}
+return null;
+};
+MochiKit.Visual.Color.fromString=function(_423){
+var self=MochiKit.Visual.Color;
+var _424=_423.substr(0,3);
+if(_424==&quot;rgb&quot;){
+return self.fromRGBString(_423);
+}else{
+if(_424==&quot;hsl&quot;){
+return self.fromHSLString(_423);
+}else{
+if(_423.charAt(0)==&quot;#&quot;){
+return self.fromHexString(_423);
+}
+}
+}
+return self.fromName(_423);
+};
+MochiKit.Visual.Color.fromHexString=function(_425){
+if(_425.charAt(0)==&quot;#&quot;){
+_425=_425.substring(1);
+}
+var _426=[];
+var i,hex;
+if(_425.length==3){
+for(i=0;i&lt;3;i++){
+hex=_425.substr(i,1);
+_426.push(parseInt(hex+hex,16)/255);
+}
+}else{
+for(i=0;i&lt;6;i+=2){
+hex=_425.substr(i,2);
+_426.push(parseInt(hex,16)/255);
+}
+}
+var _427=MochiKit.Visual.Color;
+return _427.fromRGB.apply(_427,_426);
+};
+MochiKit.Visual.Color._fromColorString=function(pre,_429,_430,_431){
+if(_431.indexOf(pre)==0){
+_431=_431.substring(_431.indexOf(&quot;(&quot;,3)+1,_431.length-1);
+}
+var _432=_431.split(/\s*,\s*/);
+var _433=[];
+for(var i=0;i&lt;_432.length;i++){
+var c=_432[i];
+var val;
+var _434=c.substring(c.length-3);
+if(c.charAt(c.length-1)==&quot;%&quot;){
+val=0.01*parseFloat(c.substring(0,c.length-1));
+}else{
+if(_434==&quot;deg&quot;){
+val=parseFloat(c)/360;
+}else{
+if(_434==&quot;rad&quot;){
+val=parseFloat(c)/(Math.PI*2);
+}else{
+val=_430[i]*parseFloat(c);
+}
+}
+}
+_433.push(val);
+}
+return this[_429].apply(this,_433);
+};
+MochiKit.Visual.Color.fromBackground=function(elem){
+var m=MochiKit.Visual;
+for(elem=MochiKit.DOM.getElement(elem);elem;elem=elem.parentNode){
+var _435=m.getElementsComputedStyle(elem,&quot;backgroundColor&quot;,&quot;background-color&quot;);
+if(!_435){
+continue;
+}
+var _436=m.Color.fromString(_435);
+if(!_436){
+break;
+}
+if(_436.asRGB().a&gt;0){
+return _436;
+}
+}
+return m.Color.whiteColor();
+};
+MochiKit.Visual._hslValue=function(n1,n2,hue){
+if(hue&gt;6){
+hue-=6;
+}else{
+if(hue&lt;0){
+hue+=6;
+}
+}
+var val;
+if(hue&lt;1){
+val=n1+(n2-n1)*hue;
+}else{
+if(hue&lt;3){
+val=n2;
+}else{
+if(hue&lt;4){
+val=n1+(n2-n1)*(4-hue);
+}else{
+val=n1;
+}
+}
+}
+return val;
+};
+MochiKit.Visual.hsvToRGB=function(hue,_439,_440,_441){
+if(arguments.length==1){
+var hsv=hue;
+hue=hsv.h;
+_439=hsv.s;
+_440=hsv.v;
+_441=hsv.a;
+}
+var red;
+var _442;
+var blue;
+if(_439==0){
+red=0;
+_442=0;
+blue=0;
+}else{
+var i=Math.floor(hue*6);
+var f=(hue*6)-i;
+var p=_440*(1-_439);
+var q=_440*(1-(_439*f));
+var t=_440*(1-(_439*(1-f)));
+switch(i){
+case 1:
+red=q;
+_442=_440;
+blue=p;
+break;
+case 2:
+red=p;
+_442=_440;
+blue=t;
+break;
+case 3:
+red=p;
+_442=q;
+blue=_440;
+break;
+case 4:
+red=t;
+_442=p;
+blue=_440;
+break;
+case 5:
+red=_440;
+_442=p;
+blue=q;
+break;
+case 6:
+case 0:
+red=_440;
+_442=t;
+blue=p;
+break;
+}
+}
+return {&quot;r&quot;:red,&quot;g&quot;:_442,&quot;b&quot;:blue,&quot;a&quot;:_441};
+};
+MochiKit.Visual.hslToRGB=function(hue,_444,_445,_446){
+if(arguments.length==1){
+var hsl=hue;
+hue=hsl.h;
+_444=hsl.s;
+_445=hsl.l;
+_446=hsl.a;
+}
+var red;
+var _447;
+var blue;
+if(_444==0){
+red=_445;
+_447=_445;
+blue=_445;
+}else{
+var m2;
+if(_445&lt;=0.5){
+m2=_445*(1+_444);
+}else{
+m2=_445+_444-(_445*_444);
+}
+var m1=(2*_445)-m2;
+var f=MochiKit.Visual._hslValue;
+var h6=hue*6;
+red=f(m1,m2,h6+2);
+_447=f(m1,m2,h6);
+blue=f(m1,m2,h6-2);
+}
+return {&quot;r&quot;:red,&quot;g&quot;:_447,&quot;b&quot;:blue,&quot;a&quot;:_446};
+};
+MochiKit.Visual.rgbToHSV=function(red,_451,blue,_452){
+if(arguments.length==1){
+var rgb=red;
+red=rgb.r;
+_451=rgb.g;
+blue=rgb.b;
+_452=rgb.a;
+}
+var max=Math.max(Math.max(red,_451),blue);
+var min=Math.min(Math.min(red,_451),blue);
+var hue;
+var _455;
+var _456=max;
+if(min==max){
+hue=0;
+_455=0;
+}else{
+var _457=(max-min);
+_455=_457/max;
+if(red==max){
+hue=(_451-blue)/_457;
+}else{
+if(_451==max){
+hue=2+((blue-red)/_457);
+}else{
+hue=4+((red-_451)/_457);
+}
+}
+hue/=6;
+if(hue&lt;0){
+hue+=1;
+}
+if(hue&gt;1){
+hue-=1;
+}
+}
+return {&quot;h&quot;:hue,&quot;s&quot;:_455,&quot;v&quot;:_456,&quot;a&quot;:_452};
+};
+MochiKit.Visual.rgbToHSL=function(red,_458,blue,_459){
+if(arguments.length==1){
+var rgb=red;
+red=rgb.r;
+_458=rgb.g;
+blue=rgb.b;
+_459=rgb.a;
+}
+var max=Math.max(red,Math.max(_458,blue));
+var min=Math.min(red,Math.min(_458,blue));
+var hue;
+var _460;
+var _461=(max+min)/2;
+var _462=max-min;
+if(_462==0){
+hue=0;
+_460=0;
+}else{
+if(_461&lt;=0.5){
+_460=_462/(max+min);
+}else{
+_460=_462/(2-max-min);
+}
+if(red==max){
+hue=(_458-blue)/_462;
+}else{
+if(_458==max){
+hue=2+((blue-red)/_462);
+}else{
+hue=4+((red-_458)/_462);
+}
+}
+hue/=6;
+if(hue&lt;0){
+hue+=1;
+}
+if(hue&gt;1){
+hue-=1;
+}
+}
+return {&quot;h&quot;:hue,&quot;s&quot;:_460,&quot;l&quot;:_461,&quot;a&quot;:_459};
+};
+MochiKit.Visual.toColorPart=function(num){
+var _463=Math.round(num).toString(16);
+if(num&lt;16){
+return &quot;0&quot;+_463;
+}
+return _463;
+};
+MochiKit.Visual.roundElement=function(e,_465){
+new MochiKit.Visual._RoundCorners(e,_465);
+};
+MochiKit.Visual.getElementsComputedStyle=function(_466,_467,_468){
+if(arguments.length==2){
+_468=_467;
+}
+var el=MochiKit.DOM.getElement(_466);
+if(!el||el==document){
+return undefined;
+}
+if(el.currentStyle){
+return el.currentStyle[_467];
+}
+if(typeof (document.defaultView)==&quot;undefined&quot;){
+return undefined;
+}
+if(document.defaultView==null){
+return undefined;
+}
+var _470=document.defaultView.getComputedStyle(el,null);
+if(typeof (_470)==&quot;undefined&quot;||_470==null){
+return undefined;
+}
+return _470.getPropertyValue(_468);
+};
+MochiKit.Visual._RoundCorners=function(e,_471){
+e=MochiKit.DOM.getElement(e);
+this._setOptions(_471);
+if(this.options.__unstable__wrapElement){
+e=this._doWrap(e);
+}
+var _472=this.options.color;
+var m=MochiKit.Visual;
+if(this.options.color==&quot;fromElement&quot;){
+_472=m.Color.fromBackground(e);
+}else{
+if(!(_472 instanceof m.Color)){
+_472=m.Color.fromString(_472);
+}
+}
+this.isTransparent=(_472.asRGB().a&lt;=0);
+var _473=this.options.bgColor;
+if(this.options.bgColor==&quot;fromParent&quot;){
+_473=m.Color.fromBackground(e.offsetParent);
+}else{
+if(!(_473 instanceof m.Color)){
+_473=m.Color.fromString(_473);
+}
+}
+this._roundCornersImpl(e,_472,_473);
+};
+MochiKit.Visual._RoundCorners.prototype={&quot;_doWrap&quot;:function(e){
+var _474=e.parentNode;
+if(typeof (document.defaultView)==&quot;undefined&quot;||document.defaultView==null){
+return e;
+}
+var _475=document.defaultView.getComputedStyle(e,null);
+if(typeof (_475)==&quot;undefined&quot;||_475==null){
+return e;
+}
+var _476=MochiKit.DOM.DIV({&quot;style&quot;:{&quot;display&quot;:&quot;block&quot;,&quot;marginTop&quot;:_475.getPropertyValue(&quot;padding-top&quot;),&quot;marginRight&quot;:_475.getPropertyValue(&quot;padding-right&quot;),&quot;marginBottom&quot;:_475.getPropertyValue(&quot;padding-bottom&quot;),&quot;marginLeft&quot;:_475.getPropertyValue(&quot;padding-left&quot;),&quot;padding&quot;:&quot;0px&quot;}});
+_476.innerHTML=e.innerHTML;
+e.innerHTML=&quot;&quot;;
+e.appendChild(_476);
+return e;
+},&quot;_roundCornersImpl&quot;:function(e,_477,_478){
+if(this.options.border){
+this._renderBorder(e,_478);
+}
+if(this._isTopRounded()){
+this._roundTopCorners(e,_477,_478);
+}
+if(this._isBottomRounded()){
+this._roundBottomCorners(e,_477,_478);
+}
+},&quot;_renderBorder&quot;:function(el,_479){
+var _480=&quot;1px solid &quot;+this._borderColor(_479);
+var _481=&quot;border-left: &quot;+_480;
+var _482=&quot;border-right: &quot;+_480;
+var _483=&quot;style='&quot;+_481+&quot;;&quot;+_482+&quot;'&quot;;
+el.innerHTML=&quot;&lt;div &quot;+_483+&quot;&gt;&quot;+el.innerHTML+&quot;&lt;/div&gt;&quot;;
+},&quot;_roundTopCorners&quot;:function(el,_484,_485){
+var _486=this._createCorner(_485);
+for(var i=0;i&lt;this.options.numSlices;i++){
+_486.appendChild(this._createCornerSlice(_484,_485,i,&quot;top&quot;));
+}
+el.style.paddingTop=0;
+el.insertBefore(_486,el.firstChild);
+},&quot;_roundBottomCorners&quot;:function(el,_487,_488){
+var _489=this._createCorner(_488);
+for(var i=(this.options.numSlices-1);i&gt;=0;i--){
+_489.appendChild(this._createCornerSlice(_487,_488,i,&quot;bottom&quot;));
+}
+el.style.paddingBottom=0;
+el.appendChild(_489);
+},&quot;_createCorner&quot;:function(_490){
+var _491=document.createElement(&quot;div&quot;);
+_491.style.backgroundColor=_490.toString();
+return _491;
+},&quot;_createCornerSlice&quot;:function(_492,_493,n,_494){
+var _495=document.createElement(&quot;span&quot;);
+var _496=_495.style;
+_496.backgroundColor=_492.toString();
+_496.display=&quot;block&quot;;
+_496.height=&quot;1px&quot;;
+_496.overflow=&quot;hidden&quot;;
+_496.fontSize=&quot;1px&quot;;
+var _497=this._borderColor(_492,_493);
+if(this.options.border&amp;&amp;n==0){
+_496.borderTopStyle=&quot;solid&quot;;
+_496.borderTopWidth=&quot;1px&quot;;
+_496.borderLeftWidth=&quot;0px&quot;;
+_496.borderRightWidth=&quot;0px&quot;;
+_496.borderBottomWidth=&quot;0px&quot;;
+_496.height=&quot;0px&quot;;
+_496.borderColor=_497.toString();
+}else{
+if(_497){
+_496.borderColor=_497.toString();
+_496.borderStyle=&quot;solid&quot;;
+_496.borderWidth=&quot;0px 1px&quot;;
+}
+}
+if(!this.options.compact&amp;&amp;(n==(this.options.numSlices-1))){
+_496.height=&quot;2px&quot;;
+}
+this._setMargin(_495,n,_494);
+this._setBorder(_495,n,_494);
+return _495;
+},&quot;_setOptions&quot;:function(_498){
+this.options={&quot;corners&quot;:&quot;all&quot;,&quot;color&quot;:&quot;fromElement&quot;,&quot;bgColor&quot;:&quot;fromParent&quot;,&quot;blend&quot;:true,&quot;border&quot;:false,&quot;compact&quot;:false,&quot;__unstable__wrapElement&quot;:false};
+MochiKit.Base.update(this.options,_498);
+this.options.numSlices=(this.options.compact?2:4);
+},&quot;_whichSideTop&quot;:function(){
+var _499=this.options.corners;
+if(this._hasString(_499,&quot;all&quot;,&quot;top&quot;)){
+return &quot;&quot;;
+}
+var _500=(_499.indexOf(&quot;tl&quot;)!=-1);
+var _501=(_499.indexOf(&quot;tr&quot;)!=-1);
+if(_500&amp;&amp;_501){
+return &quot;&quot;;
+}
+if(_500){
+return &quot;left&quot;;
+}
+if(_501){
+return &quot;right&quot;;
+}
+return &quot;&quot;;
+},&quot;_whichSideBottom&quot;:function(){
+var _502=this.options.corners;
+if(this._hasString(_502,&quot;all&quot;,&quot;bottom&quot;)){
+return &quot;&quot;;
+}
+var _503=(_502.indexOf(&quot;bl&quot;)!=-1);
+var _504=(_502.indexOf(&quot;br&quot;)!=-1);
+if(_503&amp;&amp;_504){
+return &quot;&quot;;
+}
+if(_503){
+return &quot;left&quot;;
+}
+if(_504){
+return &quot;right&quot;;
+}
+return &quot;&quot;;
+},&quot;_borderColor&quot;:function(_505,_506){
+if(_505==&quot;transparent&quot;){
+return _506;
+}else{
+if(this.options.border){
+return this.options.border;
+}else{
+if(this.options.blend){
+return _506.blendedColor(_505);
+}
+}
+}
+return &quot;&quot;;
+},&quot;_setMargin&quot;:function(el,n,_507){
+var _508=this._marginSize(n)+&quot;px&quot;;
+var _509=(_507==&quot;top&quot;?this._whichSideTop():this._whichSideBottom());
+var _510=el.style;
+if(_509==&quot;left&quot;){
+_510.marginLeft=_508;
+_510.marginRight=&quot;0px&quot;;
+}else{
+if(_509==&quot;right&quot;){
+_510.marginRight=_508;
+_510.marginLeft=&quot;0px&quot;;
+}else{
+_510.marginLeft=_508;
+_510.marginRight=_508;
+}
+}
+},&quot;_setBorder&quot;:function(el,n,_511){
+var _512=this._borderSize(n)+&quot;px&quot;;
+var _513=(_511==&quot;top&quot;?this._whichSideTop():this._whichSideBottom());
+var _514=el.style;
+if(_513==&quot;left&quot;){
+_514.borderLeftWidth=_512;
+_514.borderRightWidth=&quot;0px&quot;;
+}else{
+if(_513==&quot;right&quot;){
+_514.borderRightWidth=_512;
+_514.borderLeftWidth=&quot;0px&quot;;
+}else{
+_514.borderLeftWidth=_512;
+_514.borderRightWidth=_512;
+}
+}
+},&quot;_marginSize&quot;:function(n){
+if(this.isTransparent){
+return 0;
+}
+var o=this.options;
+if(o.compact&amp;&amp;o.blend){
+var _515=[1,0];
+return _515[n];
+}else{
+if(o.compact){
+var _516=[2,1];
+return _516[n];
+}else{
+if(o.blend){
+var _517=[3,2,1,0];
+return _517[n];
+}else{
+var _518=[5,3,2,1];
+return _518[n];
+}
+}
+}
+},&quot;_borderSize&quot;:function(n){
+var o=this.options;
+var _519;
+if(o.compact&amp;&amp;(o.blend||this.isTransparent)){
+return 1;
+}else{
+if(o.compact){
+_519=[1,0];
+}else{
+if(o.blend){
+_519=[2,1,1,1];
+}else{
+if(o.border){
+_519=[0,2,0,0];
+}else{
+if(this.isTransparent){
+_519=[5,3,2,1];
+}else{
+return 0;
+}
+}
+}
+}
+}
+return _519[n];
+},&quot;_hasString&quot;:function(str){
+for(var i=1;i&lt;arguments.length;i++){
+if(str.indexOf(arguments[i])!=-1){
+return true;
+}
+}
+return false;
+},&quot;_isTopRounded&quot;:function(){
+return this._hasString(this.options.corners,&quot;all&quot;,&quot;top&quot;,&quot;tl&quot;,&quot;tr&quot;);
+},&quot;_isBottomRounded&quot;:function(){
+return this._hasString(this.options.corners,&quot;all&quot;,&quot;bottom&quot;,&quot;bl&quot;,&quot;br&quot;);
+},&quot;_hasSingleTextChild&quot;:function(el){
+return (el.childNodes.length==1&amp;&amp;el.childNodes[0].nodeType==3);
+}};
+MochiKit.Visual.roundClass=function(_520,_521,_522){
+var _523=MochiKit.DOM.getElementsByTagAndClassName(_520,_521);
+for(var i=0;i&lt;_523.length;i++){
+roundElement(_523[i],_522);
+}
+};
+MochiKit.Visual.__new__=function(){
+var bind=MochiKit.Base.bind;
+var map=MochiKit.Base.map;
+var _524=MochiKit.Base.concat;
+this.Color.fromRGBString=bind(this.Color._fromColorString,this.Color,&quot;rgb&quot;,&quot;fromRGB&quot;,[1/255,1/255,1/255,1]);
+this.Color.fromHSLString=bind(this.Color._fromColorString,this.Color,&quot;hsl&quot;,&quot;fromHSL&quot;,[1/360,0.01,0.01,1]);
+var _525=1/3;
+var _526={black:[0,0,0],blue:[0,0,1],brown:[0.6,0.4,0.2],cyan:[0,1,1],darkGray:[_525,_525,_525],gray:[0.5,0.5,0.5],green:[0,1,0],lightGray:[2*_525,2*_525,2*_525],magenta:[1,0,1],orange:[1,0.5,0],purple:[0.5,0,0.5],red:[1,0,0],transparent:[0,0,0,0],white:[1,1,1],yellow:[1,1,0]};
+var _527=function(name,r,g,b,a){
+var rval=this.fromRGB(r,g,b,a);
+this[name]=function(){
+return rval;
+};
+return rval;
+};
+for(var k in _526){
+var name=k+&quot;Color&quot;;
+var _530=_524([_527,this.Color,name],_526[k]);
+this.Color[name]=bind.apply(null,_530);
+}
+var _531=function(){
+for(var i=0;i&lt;arguments.length;i++){
+if(!(arguments[i] instanceof Color)){
+return false;
+}
+}
+return true;
+};
+var _532=function(a,b){
+return a.compareRGB(b);
+};
+MochiKit.Base.nameFunctions(this);
+MochiKit.Base.registerComparator(this.Color.NAME,_531,_532);
+this.EXPORT_TAGS={&quot;:common&quot;:this.EXPORT,&quot;:all&quot;:MochiKit.Base.concat(this.EXPORT,this.EXPORT_OK)};
+};
+MochiKit.Visual.EXPORT=[&quot;Color&quot;,&quot;roundElement&quot;,&quot;roundClass&quot;];
+MochiKit.Visual.EXPORT_OK=[&quot;clampColorComponent&quot;,&quot;rgbToHSL&quot;,&quot;hslToRGB&quot;,&quot;rgbToHSV&quot;,&quot;hsvToRGB&quot;,&quot;toColorPart&quot;];
+MochiKit.Visual.__new__();
+if((typeof (JSAN)==&quot;undefined&quot;&amp;&amp;typeof (dojo)==&quot;undefined&quot;)||(typeof (MochiKit.__compat__)==&quot;boolean&quot;&amp;&amp;MochiKit.__compat__)){
+(function(self){
+var all=self.EXPORT_TAGS[&quot;:all&quot;];
+for(var i=0;i&lt;all.length;i++){
+this[all[i]]=self[all[i]];
+}
+})(MochiKit.Visual);
+}
+MochiKit.Visual.Color.namedColors=function(){
+return MochiKit.Base.clone(MochiKit.Visual.Color._namedColors);
+};
+MochiKit.Visual.Color._namedColors={aliceblue:&quot;#f0f8ff&quot;,antiquewhite:&quot;#faebd7&quot;,aqua:&quot;#00ffff&quot;,aquamarine:&quot;#7fffd4&quot;,azure:&quot;#f0ffff&quot;,beige:&quot;#f5f5dc&quot;,bisque:&quot;#ffe4c4&quot;,black:&quot;#000000&quot;,blanchedalmond:&quot;#ffebcd&quot;,blue:&quot;#0000ff&quot;,blueviolet:&quot;#8a2be2&quot;,brown:&quot;#a52a2a&quot;,burlywood:&quot;#deb887&quot;,cadetblue:&quot;#5f9ea0&quot;,chartreuse:&quot;#7fff00&quot;,chocolate:&quot;#d2691e&quot;,coral:&quot;#ff7f50&quot;,cornflowerblue:&quot;#6495ed&quot;,cornsilk:&quot;#fff8dc&quot;,crimson:&quot;#dc143c&quot;,cyan:&quot;#00ffff&quot;,darkblue:&quot;#00008b&quot;,darkcyan:&quot;#008b8b&quot;,darkgoldenrod:&quot;#b8860b&quot;,darkgray:&quot;#a9a9a9&quot;,darkgreen:&quot;#006400&quot;,darkgrey:&quot;#a9a9a9&quot;,darkkhaki:&quot;#bdb76b&quot;,darkmagenta:&quot;#8b008b&quot;,darkolivegreen:&quot;#556b2f&quot;,darkorange:&quot;#ff8c00&quot;,darkorchid:&quot;#9932cc&quot;,darkred:&quot;#8b0000&quot;,darksalmon:&quot;#e9967a&quot;,darkseagreen:&quot;#8fbc8f&quot;,darkslateblue:&quot;#483d8b&quot;,darkslategray:&quot;#2f4f4f&quot;,darkslategrey:&quot;#2f4f4f&quot;,darkturquoise:&quot;#00ced1&quot;,darkviolet:&quot;#9400d3&quot;,deeppink:&quot;#ff1493&quot;,deepskyblue:&quot;#00bfff&quot;,dimgray:&quot;#696969&quot;,dimgrey:&quot;#696969&quot;,dodgerblue:&quot;#1e90ff&quot;,firebrick:&quot;#b22222&quot;,floralwhite:&quot;#fffaf0&quot;,forestgre!
 en:&quot;#228b22&quot;,fuchsia:&quot;#ff00ff&quot;,gainsboro:&quot;#dcdcdc&quot;,ghostwhite:&quot;#f8f8ff&quot;,gold:&quot;#ffd700&quot;,goldenrod:&quot;#daa520&quot;,gray:&quot;#808080&quot;,green:&quot;#008000&quot;,greenyellow:&quot;#adff2f&quot;,grey:&quot;#808080&quot;,honeydew:&quot;#f0fff0&quot;,hotpink:&quot;#ff69b4&quot;,indianred:&quot;#cd5c5c&quot;,indigo:&quot;#4b0082&quot;,ivory:&quot;#fffff0&quot;,khaki:&quot;#f0e68c&quot;,lavender:&quot;#e6e6fa&quot;,lavenderblush:&quot;#fff0f5&quot;,lawngreen:&quot;#7cfc00&quot;,lemonchiffon:&quot;#fffacd&quot;,lightblue:&quot;#add8e6&quot;,lightcoral:&quot;#f08080&quot;,lightcyan:&quot;#e0ffff&quot;,lightgoldenrodyellow:&quot;#fafad2&quot;,lightgray:&quot;#d3d3d3&quot;,lightgreen:&quot;#90ee90&quot;,lightgrey:&quot;#d3d3d3&quot;,lightpink:&quot;#ffb6c1&quot;,lightsalmon:&quot;#ffa07a&quot;,lightseagreen:&quot;#20b2aa&quot;,lightskyblue:&quot;#87cefa&quot;,lightslategray:&quot;#778899&quot;,lightslategrey:&quot;#778899&quot;,lightsteelblue:&quot;#b0c4de&quot;,lightyellow:&quot;#ffffe0&quot;,lime:&quot;#00ff00&quot;,limegreen:&quot;#32cd32&quot;,linen:&quot;#faf0e6&quot;,magenta:&quot;#ff00ff&quot;,maroon:&quot;#800000&quot;,mediumaquamarine:&quot;#66cdaa&quot;,mediumblue:&quot;#0000cd&quot;,mediumorchid:&quot;#ba55d3&quot;,mediumpurple:&quot;#9370db&quot;,mediumseagreen:&quot;#3cb371&quot;,mediumslateblue:&quot;#7b68ee&quot;,mediumspringgreen:&quot;#00fa9a&quot;,mediumturquoise:&quot;#48d1c!
 c&quot;,mediumvioletred:&quot;#c71585&quot;,midnightblue:&quot;#191970&quot;,mintcream:!
 &quot;#f5fffa
&quot;,mistyrose:&quot;#ffe4e1&quot;,moccasin:&quot;#ffe4b5&quot;,navajowhite:&quot;#ffdead&quot;,navy:&quot;#000080&quot;,oldlace:&quot;#fdf5e6&quot;,olive:&quot;#808000&quot;,olivedrab:&quot;#6b8e23&quot;,orange:&quot;#ffa500&quot;,orangered:&quot;#ff4500&quot;,orchid:&quot;#da70d6&quot;,palegoldenrod:&quot;#eee8aa&quot;,palegreen:&quot;#98fb98&quot;,paleturquoise:&quot;#afeeee&quot;,palevioletred:&quot;#db7093&quot;,papayawhip:&quot;#ffefd5&quot;,peachpuff:&quot;#ffdab9&quot;,peru:&quot;#cd853f&quot;,pink:&quot;#ffc0cb&quot;,plum:&quot;#dda0dd&quot;,powderblue:&quot;#b0e0e6&quot;,purple:&quot;#800080&quot;,red:&quot;#ff0000&quot;,rosybrown:&quot;#bc8f8f&quot;,royalblue:&quot;#4169e1&quot;,saddlebrown:&quot;#8b4513&quot;,salmon:&quot;#fa8072&quot;,sandybrown:&quot;#f4a460&quot;,seagreen:&quot;#2e8b57&quot;,seashell:&quot;#fff5ee&quot;,sienna:&quot;#a0522d&quot;,silver:&quot;#c0c0c0&quot;,skyblue:&quot;#87ceeb&quot;,slateblue:&quot;#6a5acd&quot;,slategray:&quot;#708090&quot;,slategrey:&quot;#708090&quot;,snow:&quot;#fffafa&quot;,springgreen:&quot;#00ff7f&quot;,steelblue:&quot;#4682b4&quot;,tan:&quot;#d2b48c&quot;,teal:&quot;#008080&quot;,thistle:&quot;#d8bfd8&quot;,tomato:&quot;#ff6347&quot;,turquoise:&quot;#40e0d0&quot;,violet:&quot;#ee82ee&quot;,wheat:&quot;#f5deb3&quot;,white:&quot;#ffffff&quot;,whitesmoke:&quot;#f5f5f5&quot;,yellow:&quot;#ffff00&quot;,yellowgreen:&quot;#9acd32&quot;};
+if(typeof (MochiKit)==&quot;undefined&quot;){
+MochiKit={};
+}
+if(typeof (MochiKit.MochiKit)==&quot;undefined&quot;){
+MochiKit.MochiKit={};
+}
+MochiKit.MochiKit.NAME=&quot;MochiKit.MochiKit&quot;;
+MochiKit.MochiKit.VERSION=&quot;1.0&quot;;
+MochiKit.MochiKit.__repr__=function(){
+return &quot;[&quot;+this.NAME+&quot; &quot;+this.VERSION+&quot;]&quot;;
+};
+MochiKit.MochiKit.toString=function(){
+return this.__repr__();
+};
+MochiKit.MochiKit.SUBMODULES=[&quot;Base&quot;,&quot;Iter&quot;,&quot;Logging&quot;,&quot;DateTime&quot;,&quot;Format&quot;,&quot;Async&quot;,&quot;DOM&quot;,&quot;LoggingPane&quot;,&quot;Visual&quot;];
+if(typeof (JSAN)!=&quot;undefined&quot;||typeof (dojo)!=&quot;undefined&quot;){
+if(typeof (dojo)!=&quot;undefined&quot;){
+dojo.provide(&quot;MochiKit.MochiKit&quot;);
+dojo.require(&quot;MochiKit.*&quot;);
+}
+if(typeof (JSAN)!=&quot;undefined&quot;){
+JSAN.use(&quot;MochiKit.Base&quot;,[]);
+JSAN.use(&quot;MochiKit.Iter&quot;,[]);
+JSAN.use(&quot;MochiKit.Logging&quot;,[]);
+JSAN.use(&quot;MochiKit.DateTime&quot;,[]);
+JSAN.use(&quot;MochiKit.Format&quot;,[]);
+JSAN.use(&quot;MochiKit.Async&quot;,[]);
+JSAN.use(&quot;MochiKit.DOM&quot;,[]);
+JSAN.use(&quot;MochiKit.Visual&quot;,[]);
+JSAN.use(&quot;MochiKit.LoggingPane&quot;,[]);
+}
+(function(){
+var _533=MochiKit.Base.extend;
+var self=MochiKit.MochiKit;
+var _534=self.SUBMODULES;
+var _535=[];
+var _536=[];
+var _537={};
+var i,k,m,all;
+for(i=0;i&lt;_534.length;i++){
+m=MochiKit[_534[i]];
+_533(_535,m.EXPORT);
+_533(_536,m.EXPORT_OK);
+for(k in m.EXPORT_TAGS){
+_537[k]=_533(_537[k],m.EXPORT_TAGS[k]);
+}
+all=m.EXPORT_TAGS[&quot;:all&quot;];
+if(!all){
+all=_533(null,m.EXPORT,m.EXPORT_OK);
+}
+for(i=0;i&lt;all.length;i++){
+k=all[i];
+self[k]=m[k];
+}
+}
+self.EXPORT=_535;
+self.EXPORT_OK=_536;
+self.EXPORT_TAGS=_537;
+}());
+}else{
+if(typeof (MochiKit.__compat__)==&quot;undefined&quot;){
+MochiKit.__compat__=true;
+}
+(function(){
+var _538=document.getElementsByTagName(&quot;script&quot;);
+var _539=&quot;<A HREF="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul</A>&quot;;
+var base=null;
+var _540=null;
+var _541={};
+var i;
+for(i=0;i&lt;_538.length;i++){
+var src=_538[i].getAttribute(&quot;src&quot;);
+if(!src){
+continue;
+}
+_541[src]=true;
+if(src.match(/MochiKit.js$/)){
+base=src.substring(0,src.lastIndexOf(&quot;MochiKit.js&quot;));
+_540=_538[i];
+}
+}
+if(base==null){
+return;
+}
+var _542=MochiKit.MochiKit.SUBMODULES;
+_542.unshift(&quot;Compat&quot;);
+for(i=0;i&lt;_542.length;i++){
+if(MochiKit[_542[i]]){
+continue;
+}
+var uri=base+_542[i]+&quot;.js&quot;;
+if(uri in _541){
+continue;
+}
+if(document.documentElement&amp;&amp;document.documentElement.namespaceURI==_539){
+var s=document.createElementNS(_539,&quot;script&quot;);
+s.setAttribute(&quot;id&quot;,&quot;MochiKit_&quot;+base+_542[i]);
+s.setAttribute(&quot;src&quot;,uri);
+s.setAttribute(&quot;type&quot;,&quot;application/x-javascript&quot;);
+_540.parentNode.appendChild(s);
+}else{
+var tag=&quot;&lt;&quot;+&quot;script src=\&quot;&quot;+uri+&quot;\&quot; type=\&quot;text/javascript\&quot;&quot;+&quot;&gt;&quot;+&quot;&lt;&quot;+&quot;/script&quot;+&quot;&gt;&quot;;
+document.write(tag);
+}
+}
+})();
+}
+
+

Added: trunk/maay/data/MochiKitLogConsole.js
===================================================================
--- trunk/maay/data/MochiKitLogConsole.js	2005-11-15 13:08:55 UTC (rev 499)
+++ trunk/maay/data/MochiKitLogConsole.js	2005-11-15 13:51:50 UTC (rev 500)
@@ -0,0 +1,114 @@
+var consoleDoc = ''+
+'&lt;html&gt;'+
+'  &lt;head&gt;'+
+'    &lt;title&gt;Log Console&lt;/title&gt;'+
+'    &lt;script type=&quot;text/javascript&quot; src=&quot;mochikit.js&quot;&gt;&lt;/script&gt;'+
+'    &lt;script type=&quot;text/javascript&quot; src=&quot;MochiKitLogConsole.js&quot;&gt;&lt;/script&gt;'+
+'    &lt;style type=&quot;text/css&quot;&gt;'+
+'    body {'+
+'      background-color: #fff;'+
+'      color: #333;'+
+'      font-size: 8pt;'+
+'      margin: 0;'+
+'      padding: 0;'+
+'    }'+
+'    #clear {'+
+'      position: absolute;'+
+'      right: 1em;'+
+'      color: #900;'+
+'    }'+
+'    #console {'+
+'      position: absolute;'+
+'      top: 3em;'+
+'      bottom: 0;'+
+'      left: 0;'+
+'      right: 0;'+
+'      overflow: scroll;'+
+'      font-family: monospace;'+
+'      padding: 0 0.5em;'+
+'    }'+
+'    .message {'+
+'      margin: 0 0 0 0;'+
+'      padding: 0;'+
+'      border-bottom: 1px dashed #ccf;'+
+'    }'+
+'     .timestamp {'+
+'       display: block;'+
+'       font-weight: bold;'+
+'       color: #999;'+
+'     }'+
+'     .level {'+
+'       font-weight: bold;'+
+'       color: #666;'+
+'     }'+
+'    &lt;/style&gt;'+
+'  &lt;/head&gt;'+
+'  &lt;body onload=&quot;LogConsole.init()&quot;&gt;'+
+'    &lt;div id=&quot;controls&quot; /&gt;'+
+'      &lt;label&gt;&lt;input type=&quot;checkbox&quot; id=&quot;timestamp&quot; onclick=&quot;LogConsole.init()&quot;/&gt;Show timestamps&lt;/label&gt;'+
+'      &lt;a href=&quot;#&quot; id=&quot;clear&quot; onclick=&quot;LogConsole.clear(); return false;&quot;&gt;Clear&lt;/a&gt;'+
+'    &lt;/div&gt;'+
+'    &lt;div id=&quot;console&quot; /&gt;'+
+'  &lt;/body&gt;'+
+'&lt;/html&gt;'
+
+if(typeof(LogConsole) == &quot;undefined&quot;) {
+    LogConsole = {}
+}
+
+LogConsole.show = function() {
+    var consoleWindow = window.open('', 'MochiKitLogConsole', 'dependent=yes,height=600,width=400,resizable=yes');
+    consoleWindow.document.write(consoleDoc);
+    consoleWindow.document.close();
+}
+
+LogConsole.init = function() {
+    // Clear all messages
+    MochiKit.DOM.replaceChildNodes(MochiKit.DOM.getElement(&quot;console&quot;), null);
+    // Work out how much room the scroll bar along the bottom takes up o we
+    // can tell if the user was scrolled to the end of the list.
+    var console = MochiKit.DOM.getElement('console');
+    LogConsole.scrollBarHeight = console.offsetHeight-console.scrollHeight;
+    // Load the current message list into the console.
+    var logger = LogConsole.getLogger();
+    msgs = logger.getMessages();
+    forEach(msgs, LogConsole.appendMessage);
+    // Listen for new messages
+    //logger.removeListener('logConsole');
+    logger.addListener('logConsole', null, LogConsole.appendMessage);
+}
+
+LogConsole.scrollBarHeight = null;
+
+LogConsole.getLogger = function() {
+    return window.opener.logger;
+}
+
+LogConsole.appendMessage = function(message) {
+
+    var console = MochiKit.DOM.getElement('console');
+    var showTimestamp = MochiKit.DOM.getElement('timestamp').checked;
+
+    var tsTag = SPAN({'class':'timestamp'}, [message.timestamp]);
+    var levelTag = SPAN({'class':'level'}, [message.level]);
+    var infoTag = message.info;
+
+    if(showTimestamp) {
+        var tags = [tsTag, ' ', levelTag, ' ', infoTag];
+    } else {
+        var tags = [levelTag, ' ', infoTag];
+    }
+
+    var wasAtEnd = console.scrollTop+console.offsetHeight-console.scrollHeight == LogConsole.scrollBarHeight;
+    appendChildNodes(console, P({'class':'message'}, tags));
+
+    if(wasAtEnd) {
+        console.scrollTop = console.scrollHeight;
+    }
+}
+
+LogConsole.clear = function() {
+    LogConsole.getLogger().clear();
+    LogConsole.init();
+}
+

Added: trunk/maay/data/athena.js
===================================================================
--- trunk/maay/data/athena.js	2005-11-15 13:08:55 UTC (rev 499)
+++ trunk/maay/data/athena.js	2005-11-15 13:51:50 UTC (rev 500)
@@ -0,0 +1,273 @@
+function nevow_baseURL() {
+
+    // Use &quot;cached&quot; value if it exists
+    if (typeof(_nevow_baseURL) != &quot;undefined&quot;) {
+        return _nevow_baseURL;
+    }
+
+    var baseURL = this.location.toString();
+    var queryParamIndex = baseURL.indexOf('?');
+
+    if (queryParamIndex != -1) {
+        baseURL = baseURL.substring(0, queryParamIndex);
+    }
+
+    if (baseURL.charAt(baseURL.length - 1) != '/') {
+        baseURL += '/';
+    }
+
+    baseURL += 'transport';
+
+    // &quot;Cache&quot; and return
+    _nevow_baseURL = baseURL;
+    return _nevow_baseURL;
+}
+
+var nevow_debugging = true;
+function nevow_debug(msg) {
+    if (nevow_debugging) {
+        MochiKit.Logging.logDebug(msg);
+    }
+}
+
+function nevow_constructActionURL(action, arguments) {
+    var argumentQueryArgument = MochiKit.Base.serializeJSON(arguments);
+    return (nevow_baseURL()
+            + '?action='
+            + encodeURIComponent(action)
+            + '&amp;args='
+            + encodeURIComponent(argumentQueryArgument));
+}
+
+var nevow_failureCount = 0;
+var nevow_remoteCallCount = 0;
+var nevow_remoteCalls = {};
+var nevow_outstandingTransports = 0;
+var nevow_responseDispatchTable = new Object();
+
+nevow_responseDispatchTable['text/xml'] = function(d, content) {
+    d.callback(TEH_XML_PARSER(content));
+}
+
+nevow_responseDispatchTable['text/json'] = function(d, content) {
+    d.callback(content);
+}
+
+function nevow_XMLHttpRequestFinished(passthrough) {
+    nevow_outstandingTransports--;
+    return passthrough;
+}
+
+function nevow_XMLHttpRequestReady(req) {
+    nevow_debug('A request is completed: ' + req.responseText);
+
+    /* The response's content is a JSON-encoded 4-array of [Response-Id,
+     * Request-Id, Content-Type, Content].  If this is a response to a
+     * previous request, responseId will not be null.  If this is a
+     * server-initiated request, requestId will not be null.
+     */
+
+    if (req.responseText == '') {
+        /* Server timed out the transport, just re-request */
+        nevow_debug('Empty server message, reconnecting');
+        if (nevow_outstandingTransports == 0) {
+            nevow_debug('No outstanding transports, sending no-op');
+            nevow_sendNoOp();
+        }
+        return;
+    }
+
+    nevow_debug('evaluating json in responseText');
+    var responseParts = MochiKit.Base.evalJSON(req.responseText);
+    nevow_debug('evaluated it');
+
+    nevow_failureCount = 0;
+
+    var responseId = responseParts[0];
+    var requestId = responseParts[1];
+
+    if (requestId != null) {
+        nevow_debug('Got a response to a request');
+
+        var contentType = responseParts[2];
+        var contentBody = responseParts[3];
+
+        var d = nevow_remoteCalls[requestId];
+        var handler = nevow_responseDispatchTable[contentType];
+        delete nevow_remoteCalls[requestId];
+
+        if (handler != null) {
+            handler(d, contentBody);
+        } else {
+            nevow_debug(&quot;Unknown content-type: &quot; + contentType);
+            d.errback(new Error(&quot;Unhandled content type: &quot; + contentType));
+        }
+
+    } else if (responseId != null) {
+        nevow_debug('Server initiated request');
+
+        var contentBody = responseParts[2];
+
+        var objectId = contentBody[0];
+        var methodName = contentBody[1];
+        var methodArgs = contentBody[2];
+
+        /*
+        var resultD = nevow_localObjectTable[objectId].dispatch(methodName, methodArgs);
+        resultD.addCallbacks(nevow_respondToRequest
+        */
+
+        nevow_debug('Invoking ' + new String(methodName) + ' with arguments ' + new String(methodArgs));
+        var result = eval(methodName).apply(null, methodArgs);
+        nevow_debug('Invoked it');
+
+        var isDeferred = false;
+
+        if (result == undefined) {
+            nevow_debug('it was undefined');
+            result = null;
+        } else {
+            /* if it quacks like a duck ...
+               this sucks!!!  */
+            isDeferred = (typeof(result.addCallback) != 'undefined' &amp;&amp;
+                          typeof(result.addErrback) != 'undefined');
+        }
+        nevow_debug('Is it a deferred? ' + new String(isDeferred));
+
+        if (isDeferred) {
+            nevow_debug('It is a deferred, adding a callback');
+            result.addCallback(function(result) {
+                nevow_respondToRemote(responseId, result);
+            });
+        } else {
+            nevow_debug('Responding synchronously to remote request with ID ' + new String(responseId));
+            nevow_respondToRemote(responseId, result);
+        }
+
+    }
+
+    /* Client code has had a chance to run now, in response to
+     * receiving the result.  If it issued a new request, we've got an
+     * output channel already.  If it didn't, though, we might not
+     * have one.  In that case, issue a no-op to the server so it can
+     * send us things if it needs to. */
+    if (nevow_outstandingTransports == 0) {
+        nevow_sendNoOp();
+    }
+}
+
+function nevow_XMLHttpRequestFail(err) {
+    nevow_debug('A request failed!');
+
+    nevow_failureCount++;
+
+    if (nevow_failureCount &gt;= 3) {
+        nevow_debug('There are too many failures!');
+        var calls = nevow_remoteCalls;
+        nevow_remoteCalls = {};
+        for (var k in calls) {
+            calls[k].errback(new Error(&quot;Connection lost&quot;));
+        }
+        return;
+    } else {
+        nevow_debug('There are not too many failures.');
+    }
+
+    if (nevow_outstandingTransports == 0) {
+        nevow_sendNoOp();
+    }
+}
+
+function nevow_prepareRemoteAction(actionType, args) {
+
+    var url = nevow_constructActionURL(actionType, args);
+    var req = MochiKit.Async.getXMLHttpRequest();
+
+    try {
+        req.open('GET', url, true);
+        yes = 1;
+    } catch (err) {
+        return resultD = MochiKit.Async.fail(err);
+    }
+
+    nevow_outstandingTransports++;
+
+    nevow_debug(&quot;Setting livepage id &quot; + new String(nevow_livepageId));
+    req.setRequestHeader('Livepage-Id', nevow_livepageId);
+    return resultD = MochiKit.Async.succeed(req);
+}
+
+function nevow_respondToRemote(requestID, args) {
+    var reqD = nevow_prepareRemoteAction('respond', [args]);
+    reqD.addCallback(function(req) {
+        req.setRequestHeader('Response-Id', requestID);
+        var reqD2 = MochiKit.Async.sendXMLHttpRequest(req);
+        reqD2.addBoth(nevow_XMLHttpRequestFinished);
+        reqD2.addCallback(nevow_XMLHttpRequestReady);
+        reqD2.addErrback(nevow_XMLHttpRequestFail);
+    });
+}
+
+function nevow_sendNoOp() {
+    nevow_debug('Sending no-op');
+    var reqD = nevow_prepareRemoteAction('noop', []);
+    nevow_debug('Prepared remote action');
+    reqD.addCallback(function(req) {
+        nevow_debug('Got request');
+        var reqD2 = MochiKit.Async.sendXMLHttpRequest(req);
+        reqD2.addBoth(nevow_XMLHttpRequestFinished);
+        nevow_debug('Sent request');
+        reqD2.addCallback(function(ign) {
+            nevow_debug('reqD2 succeeded');
+            return nevow_XMLHttpRequestReady(req);
+        });
+        reqD2.addErrback(function(err) {
+            nevow_debug('reqD2 failed');
+            return nevow_XMLHttpRequestFail(err);
+        });
+        nevow_debug('Added callback and errback');
+    });
+}
+
+function nevow_callRemote(methodName, args) {
+    var resultDeferred = new MochiKit.Async.Deferred();
+    var reqD = nevow_prepareRemoteAction('call', MochiKit.Base.extend([methodName], args));
+    var requestId = 'c2s' + nevow_remoteCallCount;
+
+    nevow_remoteCallCount++;
+    nevow_remoteCalls[requestId] = resultDeferred;
+
+    reqD.addCallback(function(req) {
+        req.setRequestHeader('Request-Id', requestId);
+
+        var reqD2 = MochiKit.Async.sendXMLHttpRequest(req);
+        reqD2.addBoth(nevow_XMLHttpRequestFinished);
+        reqD2.addCallback(nevow_XMLHttpRequestReady);
+        return reqD2
+    });
+
+    reqD.addErrback(nevow_XMLHttpRequestFail);
+
+    return resultDeferred;
+}
+
+var server = {
+    /* Backwards compatibility API - you really want callRemote */
+    handle: function(handlerName /*, ... */ ) {
+        var args = [handlerName];
+        for (var idx = 1; idx &lt; arguments.length; idx++) {
+            args.push(arguments[idx]);
+        }
+        nevow_callRemote('handle', args).addCallback(eval);
+    },
+
+    /* Invoke a method on the server.  Return a Deferred that fires
+     * when the method completes. */
+    callRemote: function(methodName /*, ... */) {
+        var args = [];
+        for (var idx = 1; idx &lt; arguments.length; idx++) {
+            args.push(arguments[idx]);
+        }
+        return nevow_callRemote(methodName, args);
+    }
+};

Added: trunk/maay/data/liveglue.js
===================================================================
--- trunk/maay/data/liveglue.js	2005-11-15 13:08:55 UTC (rev 499)
+++ trunk/maay/data/liveglue.js	2005-11-15 13:51:50 UTC (rev 500)
@@ -0,0 +1,273 @@
+
+var nevow_clientHandleId;       /* This variable must be defined in your HTML.
+                                 */
+
+var liveevil_unload = false;
+var auto_open = true;
+
+var last_request = null;
+var last_server_message_time = null;
+
+var disconnectListeners = [];
+
+var inputListeners = [];
+var listenerId = 0;
+
+var base_url = this.location.toString();
+var queryParamIndex = base_url.indexOf('?');
+var userAgent = navigator.userAgent.toLowerCase();
+
+if (queryParamIndex != -1) {
+  base_url = base_url.substring(0, queryParamIndex);
+ }
+
+if (base_url.charAt(base_url.length-1) != '/') {
+  base_url += '/';
+ }
+
+base_url += 'livepage_client/'
+
+
+function createRequest() {
+    if (window.XMLHttpRequest) {
+      req = new XMLHttpRequest();
+    } else {
+        req = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;)
+    }
+    reqObj = new Object()
+    reqObj.request = req
+    return reqObj
+}
+
+function connect(outputNum) {
+  var xmlhttp = createRequest();
+  last_request = xmlhttp.request;
+  xmlhttp.request.onreadystatechange = function() {
+    if (xmlhttp.request.readyState == 4) {
+      if (xmlhttp.request.responseText) {
+        last_server_message_time = new Date()
+        eval(xmlhttp.request.responseText)
+        if (!liveevil_unload &amp;&amp; auto_open) {
+          connect(outputNum + 1)
+        }
+      } else {
+        for (var i=0; i&lt;disconnectListeners.length; i++) {
+          disconnectListeners[i]()
+          disconnectListeners = []
+        }
+        last_request = null
+      }
+    }
+  }
+  var U = base_url + nevow_clientHandleId + &quot;/output?outputNum=&quot; + outputNum;
+  xmlhttp.request.open(&quot;GET&quot;, U, true);
+  xmlhttp.request.send(null);
+}
+
+
+if (userAgent.indexOf(&quot;msie&quot;) != -1) {
+    /* IE specific stuff */
+    /* Abort last request so we don't 'leak' connections */
+    window.attachEvent(&quot;onbeforeunload&quot;, function() { if (last_request != null) {last_request.abort();} } )
+    /* Set unload flag */
+    window.attachEvent(&quot;onbeforeunload&quot;, function() { liveevil_unload = true; } )
+} else if (document.implementation &amp;&amp; document.implementation.createDocument) {
+    /* Mozilla specific stuff (onbeforeunload is in v1.7+ only) */
+    window.addEventListener(&quot;beforeunload&quot;, function() { liveevil_unload = true; }, false)
+}
+
+
+function listener(callWhenAllDone) {
+    this.listenerId = listenerId
+    listenerId += 1
+    this.events = []
+    this.callWhenAllDone = callWhenAllDone
+    this.fired = false
+    this.inputDone = function(what) {
+        var found = false
+        for (var i=0; i&lt;this.events.length; i++) {
+            if (this.events[i] == what) {
+                this.events.splice(i, 1)
+                found = true
+                break
+            }
+        }
+        if (this.events.length == 0) {
+            if (this.fired) {
+                alert(&quot;Tried to fire twice :(&quot;)
+            } else {
+                this.callWhenAllDone()
+                this.fired = true
+            }
+        }
+    }
+}
+
+
+function listenForInputEvents(callWhenAllDone) {
+    var newListener = new listener(callWhenAllDone)
+    inputListeners.push(newListener)
+    return newListener
+}
+
+
+function stopListening(theListener) {
+    for (var i=0; i&lt;inputListeners.length; i++) {
+        if (inputListeners[i] == theListener) {
+            inputListeners.splice(i, 1)
+            break
+        }
+    }
+    if (theListener.events.length == 0) {
+        theListener.callWhenAllDone()
+    }
+}
+
+function addDisconnectListener(callback) {
+    disconnectListeners.push(callback)
+    return callback
+}
+
+function delDisconnectListener(theListener) {
+    for (var i=0; i&lt;disconnectListeners.length; i++) {
+	if (disconnectListeners[i] == theListener){
+	    disconnectListeners.splice(i, 1)
+	    break
+	}
+    }
+}
+
+function nevow_clientToServerEvent(theTarget, evalAfterDone) {
+    if (theTarget != 'close' &amp;&amp; liveevil_unload) {
+        // Server had previously closed the output; let's open it again.
+        if (auto_open) {
+            liveevil_unload = false }
+        connect(0)
+    }
+    var additionalArguments = ''
+    for (i = 2; i&lt;arguments.length; i++) {
+        additionalArguments += '&amp;arguments='
+        additionalArguments += encodeURIComponent(arguments[i])
+    }
+    var input = createRequest()
+    input.request.onreadystatechange = function() {
+        if (input.request.readyState == 4) {
+            eval(input.request.responseText)
+            if (evalAfterDone) {
+               eval(evalAfterDone)
+            }
+            for (var i=0; i&lt;input.events.length; i++) {
+                input.events[i].inputDone(input.request)
+            }
+        }
+    }
+    input.events = []
+    for (var i=0; i&lt;inputListeners.length; i++) {
+        inputListeners[i].events.push(input.request)
+        input.events.push(inputListeners[i])
+    }
+    input.request.open(
+      &quot;GET&quot;,
+      base_url +
+      nevow_clientHandleId +
+      &quot;/input?&quot; +
+      &quot;handler-path=&amp;handler-name=&quot; +
+      encodeURIComponent(theTarget) +
+      additionalArguments)
+
+    input.request.send(null)
+}
+
+function nevow_setNode(node, to) {
+    document.getElementById(node).innerHTML = to;
+}
+
+function nevow_appendNode(node, what) {
+    var oldnode = document.getElementById(node);
+    var newspan = document.createElement('span');
+    newspan.innerHTML = what;
+    for (i=0; i&lt;newspan.childNodes.length; i++) {
+        oldnode.appendChild(newspan.childNodes[i]);
+    }
+}
+
+function nevow_prependNode(node, what) {
+  var oldnode = document.getElementById(node);
+  var newspan = document.createElement('span');
+  newspan.innerHTML = what;
+  for (i=newspan.childNodes.length-1; i&gt;=0; i--){
+    if (oldnode.childNodes.length == 0)
+      oldnode.appendChild(newspan.childNodes[i]);
+    else
+      oldnode.insertBefore(newspan.childNodes[i], oldnode.childNodes[0]);
+  }
+}
+
+function nevow_insertNode(node, before) {
+    var oldnode = document.getElementById('before');
+    var newspan = document.createElement('span');
+    newspan.innerHTML = what;
+    var previous = oldnode;
+    for (i=0; i&lt;newspan.childNodes.length; i++) {
+        previous.parentNode.insertBefore(newspan.childNodes[i], previous);
+        previous = newspan.childNodes[i];
+    }
+}
+
+function nevow_closeLive(evalAfterDone) {
+    // Tell connect() not to complain at us when the server closes the
+    // connection with no serverToClientEvent
+    liveevil_unload = true
+    var old_auto_open = auto_open
+    auto_open = false
+    // Tell the server we know we're done, send us an empty event
+    // evalAfterDone will be evalled after the server sends us an empty event
+    nevow_clientToServerEvent('close', '', evalAfterDone)
+    auto_open = old_auto_open
+}
+
+
+var server = {
+    handle: function(handlerName) {
+        var args = [handlerName, '']
+        for (var i = 1; i &lt; arguments.length; i++) {
+            args.push(arguments[i])
+        }
+        nevow_clientToServerEvent.apply(this, args)
+    }
+};
+
+function nevow_startLivePage() {
+  if (nevow_clientHandleId == null) {
+    alert('UNSUPPORTED!  USE AT YOUR OWN RISK!');
+    var x = createRequest();
+    x.request.onreadstatechange = function () {
+      if (x.request.readyState == 4) {
+        nevow_clientHandleId = x.request.responseText;
+        nevow_startLivePage();
+      }
+    };
+    x.request.open(&quot;GET&quot;, base_url + &quot;new&quot;);
+    x.request.send(null);
+  } else {
+    connect(0);
+  }
+}
+
+
+var nevow_origOnLoad = window.onload;
+function nevow_onLoad() {
+    if (nevow_origOnLoad) {
+      if(typeof(nevow_origOnLoad) == &quot;string&quot;) {
+        eval(nevow_origOnLoad);
+      }
+      else {
+        nevow_origOnLoad();
+      }
+    }      
+    if (auto_open) {
+        nevow_startLivePage();
+    }
+}
+window.onload = nevow_onLoad;
+

Added: trunk/maay/data/livetest-postscripts.js
===================================================================
--- trunk/maay/data/livetest-postscripts.js	2005-11-15 13:08:55 UTC (rev 499)
+++ trunk/maay/data/livetest-postscripts.js	2005-11-15 13:51:50 UTC (rev 500)
@@ -0,0 +1,49 @@
+
+var testFrameNode = document.getElementById('testframe');
+testFrameNode.addEventListener('load', loadNotify, true);
+
+var sendSubmitEvent = function(theTarget, callWhenDone) {
+    var theEvent = testFrameNode.contentDocument.createEvent(&quot;HTMLEvents&quot;);
+    theEvent.initEvent(&quot;submit&quot;,
+        true,
+        true);
+    theTarget.dispatchEvent(theEvent);
+    callWhenDone()
+}
+
+var ifTesteeUsingLivePage = function(runThisCode, otherwise) {
+    if (testFrameNode.contentDocument.defaultView.listenForInputEvents) {
+        runThisCode()
+    } else {
+        otherwise()
+    }
+}
+
+var sendClickEvent = function(theTarget, callWhenDone) {
+    var doEventOfType = function(eventType) {
+        var theEvent = testFrameNode.contentDocument.createEvent(&quot;MouseEvents&quot;);
+        var evt = document.createEvent(&quot;MouseEvents&quot;)
+        evt.initMouseEvent(eventType,
+            true, //can bubble
+            true,
+            window,
+            1,
+            theTarget.offsetLeft + theTarget.offsetWidth / 2 + window.screenX, //screen x
+            theTarget.offsetTop + theTarget.offsetTop / 2 + window.screenY, //screen y
+            theTarget.offsetLeft + theTarget.offsetWidth / 2, //client x
+            theTarget.offsetTop + theTarget.offsetTop / 2, //client y
+            false,
+            false,
+            false,
+            false,
+            1,
+            theTarget);
+
+        theTarget.dispatchEvent(evt);
+    }
+    doEventOfType('mousedown');
+    doEventOfType('mouseup');
+    doEventOfType('click');
+    callWhenDone();
+}
+

Added: trunk/maay/data/livetest.js
===================================================================
--- trunk/maay/data/livetest.js	2005-11-15 13:08:55 UTC (rev 499)
+++ trunk/maay/data/livetest.js	2005-11-15 13:51:50 UTC (rev 500)
@@ -0,0 +1,35 @@
+
+var loadObservers = [];
+
+var addLoadObserver = function(observer) {
+    loadObservers.push(observer);
+}
+
+var loadNotify = function() {
+    for (var i in loadObservers) {
+        loadObservers[i]();
+    }
+    loadObservers = [];
+}
+
+var numPassed = 0;
+var numFailed = 0;
+
+var passed = function(whichTest) {
+    numPassed += 1;
+    document.getElementById('test-'+whichTest).className = 'test-passes';
+    document.getElementById('test-passes').innerHTML = numPassed;
+}
+
+var failed = function(whichTest, text) {
+    numFailed += 1;
+    var testRow = document.getElementById('test-'+whichTest)
+    testRow.className = 'test-failures';
+    testRow.childNodes[0].title = text;
+    document.getElementById('test-failures').innerHTML = numFailed;
+}
+
+var setContentLocation = function(newLocation) {
+    return document.getElementById('testframe').contentDocument.location = newLocation;
+}
+

Modified: trunk/maay/webapplication.py
===================================================================
--- trunk/maay/webapplication.py	2005-11-15 13:08:55 UTC (rev 499)
+++ trunk/maay/webapplication.py	2005-11-15 13:51:50 UTC (rev 500)
@@ -22,7 +22,6 @@
 __revision__ = '$Id$'
 
 from datetime import datetime
-#from xmlrpclib import ServerProxy
 from itertools import cycle
 from tempfile import mkdtemp
 import os, os.path as osp
@@ -380,6 +379,20 @@
             self.querier.pushDocuments(self.queryId, results, provider=None)
             self.results = self.querier.getQueryResults(self.queryId, offset=0)
             
+    def childFactory(self, ctx, name):
+        print &quot;~&quot;*80
+        print self._javascript
+        print name, get_path_of(self._javascript[name])
+        if name in self._javascript:
+            return static.File(get_path_of(self._javascript[name]))
+
+# XXX: do we need to override the following 2 methods too ?
+##     def child_MochiKit(self, ctx):
+##         return static.File(get_path_of('MochiKit'))
+
+##     def child_MochiKitLogConsole(self, ctx):
+##         return static.File(get_path_of('MochiKit'))
+        
     def onNewResults(self, provider, results):
         results = [Document(**params) for params in results]
         self.querier.pushDocuments(self.queryId, results, provider)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000470.html">[Maay-svncheckins] r499 - trunk/maay
</A></li>
	<LI>Next message: <A HREF="000472.html">[Maay-svncheckins] r501 - trunk/maay
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#471">[ date ]</a>
              <a href="thread.html#471">[ thread ]</a>
              <a href="subject.html#471">[ subject ]</a>
              <a href="author.html#471">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/maay-svncheckins">More information about the Maay-svncheckins
mailing list</a><br>
</body></html>
